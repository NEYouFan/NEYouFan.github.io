<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Jenkins-ci容器化在Android项目构建中的应用 | 网易前端技术部</title>
  <meta name="author" content="网易前端技术部">
  
  <meta name="description" content="网易杭研前端技术部，分享最前沿的技术。">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Jenkins-ci容器化在Android项目构建中的应用"/>
  <meta property="og:site_name" content="网易前端技术部"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="网易前端技术部" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">网易前端技术部</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">主页</a></li>
    
      <li><a href="/archives">归档</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-12-08T16:00:00.000Z"><a href="/2016/12/09/android/Jenkins-ci容器化在Android项目构建中的应用（公众号版）/">2016-12-09</a></time>
      
      
  
    <h1 class="title">Jenkins-ci容器化在Android项目构建中的应用</h1>
  

    </header>
    <div class="entry">
      
        <p>&#x968F;&#x7740;&#x8F6F;&#x4EF6;&#x5F00;&#x53D1;&#x590D;&#x6742;&#x5EA6;&#x7684;&#x4E0D;&#x65AD;&#x63D0;&#x9AD8;&#xFF0C;&#x5982;&#x4F55;&#x80FD;&#x5728;&#x4E0D;&#x65AD;&#x53D8;&#x5316;&#x7684;&#x9700;&#x6C42;&#x4E2D;&#x5FEB;&#x901F;&#x9002;&#x5E94;&#x548C;&#x4FDD;&#x8BC1;&#x8F6F;&#x4EF6;&#x7684;&#x8D28;&#x91CF;&#x663E;&#x5F97;&#x5C24;&#x5176;&#x7684;&#x91CD;&#x8981;&#xFF0C;<a href="http://baike.baidu.com/view/5253255.htm" target="_blank" rel="external">&#x6301;&#x7EED;&#x96C6;&#x6210;</a>&#x6B63;&#x662F;&#x9488;&#x5BF9;&#x8FD9;&#x4E00;&#x7C7B;&#x95EE;&#x9898;&#x7684;&#x4E00;&#x79CD;&#x8F6F;&#x4EF6;&#x5F00;&#x53D1;&#x5B9E;&#x8DF5;&#x3002;<a id="more"></a></p>
<p>&#x672C;&#x6587;&#x4E2D;&#x7684;<code>Jenkins-ci</code>&#x5BB9;&#x5668;&#x5316;&#x65B9;&#x6848;&#x80FD;&#x591F;&#x5728;&#x9879;&#x76EE;&#x6784;&#x5EFA;&#x8FC7;&#x7A0B;&#x4E2D;&#x63D0;&#x53D6;&#x51FA;&#x66F4;&#x591A;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x9700;&#x6C42;&#x4FE1;&#x606F;&#x5E76;&#x8FDB;&#x4E00;&#x6B65;&#x5C06;&#x6301;&#x7EED;&#x96C6;&#x6210;&#x7684;&#x73AF;&#x5883;&#x53C2;&#x6570;&#x914D;&#x7F6E;&#x6807;&#x51C6;&#x5316;&#x3002;<br>&#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x9879;&#x76EE;&#x7684;&#x6784;&#x5EFA;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x5BF9;&#x7528;&#x6237;&#x6BD4;&#x8F83;&#x5173;&#x5FC3;&#x7684;&#x4FE1;&#x606F;&#xFF08;&#x5982;&#x4EE3;&#x7801;&#x8D28;&#x91CF;&#x3001;<code>apk</code>&#x65B9;&#x6CD5;&#x6570;&#x548C;&#x5927;&#x5C0F;&#x3001;&#x8D44;&#x6E90;&#x6587;&#x4EF6;&#x53D8;&#x5316;&#x3001;&#x4EE3;&#x7801;&#x63D0;&#x4EA4;&#x8BB0;&#x5F55;&#x7B49;&#xFF09;&#x8FDB;&#x884C;&#x8DDF;&#x8E2A;&#x3001;&#x6536;&#x96C6;&#x3001;&#x5206;&#x6790;&#x548C;&#x7EDF;&#x8BA1;&#xFF0C;&#x5E76;&#x5C06;&#x7ED3;&#x679C;&#x4EE5;&#x56FE;&#x8868;&#x7684;&#x5F62;&#x5F0F;&#x5728;&#x901A;&#x77E5;&#x90AE;&#x4EF6;&#x4E2D;&#x5C55;&#x73B0;&#x7ED9;&#x7528;&#x6237;&#xFF0C;&#x8BA9;&#x7528;&#x6237;&#x5BF9;&#x9879;&#x76EE;&#x7684;&#x8FED;&#x4EE3;&#x60C5;&#x51B5;&#x6709;&#x66F4;&#x591A;&#x7684;&#x4E86;&#x89E3;&#x3002;</p>
<h2 id="1-Jenkins&#x914D;&#x7F6E;&#x4EE5;&#x53CA;&#x6784;&#x5EFA;&#x901A;&#x77E5;&#x90AE;&#x4EF6;&#x5185;&#x5BB9;&#x5B9A;&#x5236;"><a href="#1-Jenkins&#x914D;&#x7F6E;&#x4EE5;&#x53CA;&#x6784;&#x5EFA;&#x901A;&#x77E5;&#x90AE;&#x4EF6;&#x5185;&#x5BB9;&#x5B9A;&#x5236;" class="headerlink" title="1 Jenkins&#x914D;&#x7F6E;&#x4EE5;&#x53CA;&#x6784;&#x5EFA;&#x901A;&#x77E5;&#x90AE;&#x4EF6;&#x5185;&#x5BB9;&#x5B9A;&#x5236;"></a>1 Jenkins&#x914D;&#x7F6E;&#x4EE5;&#x53CA;&#x6784;&#x5EFA;&#x901A;&#x77E5;&#x90AE;&#x4EF6;&#x5185;&#x5BB9;&#x5B9A;&#x5236;</h2><h3 id="1-1-Jenkins&#x5B89;&#x88C5;&#x3001;&#x914D;&#x7F6E;&#x4E0E;&#x4F7F;&#x7528;"><a href="#1-1-Jenkins&#x5B89;&#x88C5;&#x3001;&#x914D;&#x7F6E;&#x4E0E;&#x4F7F;&#x7528;" class="headerlink" title="1.1 Jenkins&#x5B89;&#x88C5;&#x3001;&#x914D;&#x7F6E;&#x4E0E;&#x4F7F;&#x7528;"></a>1.1 Jenkins&#x5B89;&#x88C5;&#x3001;&#x914D;&#x7F6E;&#x4E0E;&#x4F7F;&#x7528;</h3><p>&#x5173;&#x4E8E;&#x8BE6;&#x7EC6;&#x7684;Jenkins&#x5B89;&#x88C5;&#x3001;&#x914D;&#x7F6E;&#x4E0E;&#x4F7F;&#x7528;&#x8BF4;&#x660E;&#xFF0C;&#x53EF;&#x53C2;&#x8003;&#x6587;&#x7AE0;<a href="http://wangkuiwu.github.io/2015/08/07/jenkins-01/" target="_blank" rel="external">Jenkins&#x5DE5;&#x5177;(&#x4E00;)&#x4E4B; Jenkins&#x96C6;&#x6210;android&#x5DE5;&#x7A0B;</a><br>&#x548C;<a href="http://wangkuiwu.github.io/2015/08/07/jenkins-02/" target="_blank" rel="external">Jenkins&#x5DE5;&#x5177;(&#x4E8C;)&#x4E4B; Jenkins&#x96C6;&#x6210;android&#x5DE5;&#x7A0B;</a>&#xFF0C;&#x6587;&#x4E2D;&#x4E0D;&#x518D;&#x8BE6;&#x7EC6;&#x53D9;&#x8FF0;&#x3002;</p>
<p>&#x5176;&#x4E2D;&#xFF0C;&#x6784;&#x5EFA;&#x4E2D;&#x4F7F;&#x7528;&#x5230;&#x7684;&#x63D2;&#x4EF6;&#x51E0;&#x4E2A;&#x4E3B;&#x8981;&#x63D2;&#x4EF6;&#xFF1A;</p>
<ul>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/Git+Plugin" target="_blank" rel="external">Git plugin</a> Git&#x5DE5;&#x5177;&#x96C6;&#x6210;</li>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/GitLab+Plugin" target="_blank" rel="external">Gitlab Plugin</a>&#x548C;<a href="https://wiki.jenkins-ci.org/display/JENKINS/Gitlab+Hook+Plugin" target="_blank" rel="external">Gitlab Hook Plugin</a> &#x652F;&#x6301;Gitlab&#x9879;&#x76EE;&#x6784;&#x5EFA;</li>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/Gradle+Plugin" target="_blank" rel="external">Gradle plugin</a> Gradle&#x5DE5;&#x5177;&#x96C6;&#x6210;</li>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/Email-ext+plugin" target="_blank" rel="external">Email Extension Plugin</a> &#x6784;&#x5EFA;&#x7ED3;&#x6784;&#x90AE;&#x4EF6;&#x901A;&#x77E5;</li>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/Git+Changelog+Plugin" target="_blank" rel="external">Git Changelog Plugin</a> &#x83B7;&#x53D6;Git&#x63D0;&#x4EA4;&#x8BB0;&#x5F55;</li>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/Android+Lint+Plugin" target="_blank" rel="external">Android Lint Plugin</a> &#x6536;&#x96C6;&#x5206;&#x6790;Android Lint&#x68C0;&#x67E5;&#x7ED3;&#x679C;</li>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/FindBugs+Plugin" target="_blank" rel="external">FindBugs Plugin</a> &#x6536;&#x96C6;&#x5206;&#x6790;FindBugs&#x68C0;&#x67E5;&#x7ED3;&#x679C;</li>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/HTML+Publisher+Plugin" target="_blank" rel="external">HTML Publisher plugin</a> &#x652F;&#x6301;HTML&#x62A5;&#x544A;</li>
</ul>
<h3 id="1-2-&#x6784;&#x5EFA;&#x7ED3;&#x679C;&#x90AE;&#x4EF6;&#x5B9A;&#x5236;"><a href="#1-2-&#x6784;&#x5EFA;&#x7ED3;&#x679C;&#x90AE;&#x4EF6;&#x5B9A;&#x5236;" class="headerlink" title="1.2 &#x6784;&#x5EFA;&#x7ED3;&#x679C;&#x90AE;&#x4EF6;&#x5B9A;&#x5236;"></a>1.2 &#x6784;&#x5EFA;&#x7ED3;&#x679C;&#x90AE;&#x4EF6;&#x5B9A;&#x5236;</h3><p>&#x5B8C;&#x6210;<code>Jenkins</code>&#x7684;&#x5B89;&#x88C5;&#x4EE5;&#x53CA;&#x73AF;&#x5883;&#x53C2;&#x6570;&#x914D;&#x7F6E;&#x540E;&#xFF0C;&#x65B0;&#x5EFA;&#x4E00;&#x4E2A;&#x9879;&#x76EE;&#x7528;&#x4E8E;&#x6784;&#x5EFA;&#xFF0C;&#x9879;&#x76EE;&#x6784;&#x5EFA;&#x5B8C;&#x6210;&#x540E;&#x9700;&#x8981;&#x5C06;&#x7ED3;&#x679C;&#x5185;&#x5BB9;&#x901A;&#x8FC7;&#x90AE;&#x4EF6;&#x7684;&#x65B9;&#x5F0F;&#x901A;&#x77E5;&#x7528;&#x6237;&#x3002;&#x5C06;&#x6784;&#x5EFA;&#x7ED3;&#x679C;&#x901A;&#x77E5;&#x5230;&#x7528;&#x6237;&#x7684;&#x90AE;&#x4EF6;&#x5185;&#x5BB9;&#x7684;&#x5B9A;&#x5236;&#xFF0C;&#x5219;&#x662F;&#x672C;&#x6B21;&#x5B9E;&#x8DF5;&#x7684;&#x91CD;&#x70B9;&#x3002;</p>
<p>&#x672C;&#x6B21;&#x81EA;&#x52A8;&#x5316;&#x6784;&#x5EFA;&#x5C06;&#x5305;&#x62EC;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x5185;&#x5BB9;&#xFF1A;<code>FireLine</code>&#xFF08;&#x6E90;&#x7801;&#x68C0;&#x67E5;&#xFF09;&#x3001;<code>Android Lint</code>&#x3001;<code>FindBugs</code>&#xFF08;Class&#x6587;&#x4EF6;&#x68C0;&#x67E5;&#xFF09;&#x3001;<code>Apk</code>&#x5305;&#x5927;&#x5C0F;&#x548C;&#x65B9;&#x6CD5;&#x6570;&#x7EDF;&#x8BA1;&#x3001;&#x8D44;&#x6E90;&#x6587;&#x4EF6;&#x7EDF;&#x8BA1;&#xFF0C;&#x4EE5;&#x53CA;<code>Git commit</code>&#x65E5;&#x5FD7;&#x5206;&#x6790;&#x3002;</p>
<h4 id="1-2-1-Email-Extension-&#x914D;&#x7F6E;"><a href="#1-2-1-Email-Extension-&#x914D;&#x7F6E;" class="headerlink" title="1.2.1 Email Extension &#x914D;&#x7F6E;"></a>1.2.1 Email Extension &#x914D;&#x7F6E;</h4><p>&#x6784;&#x5EFA;&#x7ED3;&#x679C;&#x90AE;&#x4EF6;&#x5185;&#x5BB9;&#x5B9A;&#x5236;&#x4F9D;&#x8D56;&#x4E8E;&#x524D;&#x9762;&#x63D0;&#x5230;&#x7684;<code>Email Extension Plugin</code>&#xFF0C;&#x8BE5;&#x63D2;&#x4EF6;&#x76EE;&#x524D;&#x652F;&#x6301;<code>Jelly</code>&#x548C;<code>Groovy</code>&#x4E24;&#x79CD;&#x8BED;&#x6CD5;&#x7F16;&#x5199;&#x6A21;&#x677F;&#xFF0C;&#x672C;&#x6587;&#x7684;&#x6A21;&#x677F;&#x5185;&#x5BB9;&#x5B9A;&#x5236;&#x5C06;&#x91C7;&#x7528;<code>Groovy</code>&#xFF08;&#x4E2A;&#x4EBA;&#x8BA4;&#x4E3A;<code>Jelly</code>&#x6807;&#x7B7E;&#x4E0D;&#x591F;&#x7075;&#x6D3B;&#xFF09;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x521B;&#x5EFA;&#x7684;&#x6A21;&#x677F;&#x6587;&#x4EF6;&#x8981;&#x653E;&#x5728;<code>Jenkins</code>&#x6839;&#x76EE;&#x5F55;&#x4E0B;&#x7684;<code>email-templates</code>&#x6587;&#x4EF6;&#x5939;&#x4E0B;&#x3002;&#x6A21;&#x677F;&#x6587;&#x4EF6;&#x914D;&#x7F6E;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">${SCRIPT, template=&quot;ht-ci.template&quot;}</div></pre></td></tr></table></figure>
<p>&#x53E6;&#x5916;&#xFF0C;&#x60F3;&#x8981;&#x5728;&#x6A21;&#x677F;&#x4E2D;&#x83B7;&#x53D6;&#x6784;&#x5EFA;&#x7ED3;&#x679C;&#x4FE1;&#x606F;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x83B7;&#x53D6;<code>Jenkins</code>&#x73AF;&#x5883;&#x4E2D;&#x7684;<code>Action</code>&#x5BF9;&#x8C61;&#x6765;&#x5B9E;&#x73B0;&#x3002;<code>Action</code>&#x662F;&#x63D2;&#x4EF6;&#x7528;&#x6765;&#x5728;<code>Job</code>&#x6216;<code>Build</code>&#x9875;&#x9762;&#x589E;&#x52A0;&#x529F;&#x80FD;&#x7684;&#x4E00;&#x79CD;&#x4E3B;&#x8981;&#x65B9;&#x5F0F;&#xFF0C;&#x662F;<code>Jenkins</code>&#x6700;&#x5E38;&#x7528;&#x7684;&#x4E00;&#x4E2A;&#x6269;&#x5C55;&#x70B9;&#x3002;&#x5982;<code>org.jenkinsci.plugins.android_lint.LintResultAction</code>&#x3001;hudson.plugins.findbugs.FindBugsResultAction&#x7B49;&#xFF0C;&#x540E;&#x6587;&#x5C06;&#x591A;&#x6B21;&#x7528;&#x5230;&#x3002;</p>
<h4 id="1-2-2-Android-Lint"><a href="#1-2-2-Android-Lint" class="headerlink" title="1.2.2 Android Lint"></a>1.2.2 Android Lint</h4><p><code>Android Lint</code>&#x662F;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x4EE3;&#x7801;&#x5206;&#x6790;&#x5DE5;&#x5177;&#xFF0C;&#x5B83;&#x80FD;&#x591F;&#x5BF9;&#x4F60;&#x7684;<code>Android</code>&#x9879;&#x76EE;&#x4E2D;&#x6F5C;&#x5728;&#x7684;<code>bug</code>&#x3001;&#x53EF;&#x4F18;&#x5316;&#x7684;&#x4EE3;&#x7801;&#x3001;&#x5B89;&#x5168;&#x6027;&#x3001;&#x6027;&#x80FD;&#x3001;&#x53EF;&#x7528;&#x6027;&#x3001;&#x53EF;&#x8BBF;&#x95EE;&#x6027;&#x3001;&#x56FD;&#x9645;&#x5316;&#x7B49;&#x8FDB;&#x884C;&#x68C0;&#x67E5;&#x3002;&#x652F;&#x6301;&#x81EA;&#x5B9A;&#x4E49;Lint&#x89C4;&#x5219;&#xFF0C;&#x53EF;&#x53C2;&#x8003;&#x6587;&#x7AE0;<a href="http://carrotsight.com/2016/01/29/%E6%B5%85%E8%B0%88Android%E8%87%AA%E5%AE%9A%E4%B9%89Lint%E8%A7%84%E5%88%99%E7%9A%84%E5%AE%9E%E7%8E%B0%20%EF%BC%88%E4%B8%80%EF%BC%89.html" target="_blank" rel="external">&#x6D45;&#x8C08;Android&#x81EA;&#x5B9A;&#x4E49;Lint&#x89C4;&#x5219;&#x7684;&#x5B9E;&#x73B0; &#xFF08;&#x4E00;&#xFF09;</a>&#x3001;<a href="http://carrotsight.com/2016/02/01/%E6%B5%85%E8%B0%88Android%E8%87%AA%E5%AE%9A%E4%B9%89Lint%E8%A7%84%E5%88%99%E7%9A%84%E5%AE%9E%E7%8E%B0%20%EF%BC%88%E4%BA%8C%EF%BC%89.html" target="_blank" rel="external">&#x6D45;&#x8C08;Android&#x81EA;&#x5B9A;&#x4E49;Lint&#x89C4;&#x5219;&#x7684;&#x5B9E;&#x73B0; &#xFF08;&#x4E8C;&#xFF09;</a>&#x3002;</p>
<p>&#x5B89;&#x88C5;&#x63D2;&#x4EF6;<code>Android Lint Plugin</code>&#x540E;&#xFF0C;&#x8FDB;&#x5165;&#x9879;&#x76EE;&#x7684;&#x914D;&#x7F6E;&#x9875;&#xFF0C;&#x5E76;&#x6DFB;&#x52A0;&#x6784;&#x5EFA;&#x540E;&#x64CD;&#x4F5C;<code>Publish Android Lint results</code>&#xFF0C;&#x6839;&#x636E;&#x9875;&#x9762;&#x63D0;&#x793A;&#x8BBE;&#x7F6E;&#x53C2;&#x6570;&#xFF0C;&#x82E5;&#x4E0D;&#x8BBE;&#x7F6E;&#x53C2;&#x6570;&#xFF0C;&#x5219;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x53C2;&#x6570;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x5728;<code>Invoke Gradle Script</code>&#x7684;<code>Task</code>&#x4E2D;&#x6DFB;&#x52A0;&#x5BF9;&#x5E94;&#x7684;<code>lint</code>&#x68C0;&#x67E5;&#x4EFB;&#x52A1;&#x3002;</p>
<p>&#x901A;&#x8FC7;&#x9605;&#x8BFB;<a href="https://github.com/jenkinsci/android-lint-plugin" target="_blank" rel="external"> android-lint-plugin </a>&#x7684;&#x6E90;&#x7801;&#x53EF;&#x77E5;&#xFF0C;&#x53EA;&#x8981;&#x83B7;&#x53D6;<a href="https://github.com/jenkinsci/android-lint-plugin/blob/8e88de5c9ec2f2d58bf0965592f6ffed040f0542/src/main/java/org/jenkinsci/plugins/android_lint/LintResultAction.java" target="_blank" rel="external">org.jenkinsci.plugins.android_lint.LintResultAction</a>&#x5BF9;&#x5E94;&#x7684;<code>Action</code>&#x5B9E;&#x4F8B;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x5230;<code>lint</code>&#x68C0;&#x67E5;&#x7684;&#x6570;&#x636E;&#x3002;</p>
<p>&#x6700;&#x7EC8;&#xFF0C;&#x90AE;&#x4EF6;&#x4E2D;&#x7684;&#x663E;&#x793A;&#x7ED3;&#x679C;&#x5982;&#x56FE;&#xFF1A;</p>
<p><img src="https://nos.netease.com/popo/9da8a7374fe8ba7f4b91e78acb27392e.jpg" alt=""></p>
<p>&#x70B9;&#x51FB;&#x94FE;&#x63A5;&#x5730;&#x5740;&#xFF0C;&#x4F1A;&#x8DF3;&#x8F6C;&#x5230;<code>Lint Issues</code>&#x7684;&#x5305;&#x542B;&#x56FE;&#x6587;&#x63CF;&#x8FF0;&#x7684;&#x754C;&#x9762;&#xFF0C;&#x5982;&#x56FE;&#xFF1A;</p>
<p><img src="http://nos.netease.com/knowledge/e8b39b38-131f-4043-9178-3fc8ad4861c1" alt="Lint Issues"> </p>
<p>&#x4E0D;&#x8FC7;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5728;<code>Gradle</code>&#x63D2;&#x4EF6;<code>com.android.application</code>&#x7684;<code>android</code>&#x5BF9;&#x8C61;&#x4E2D;&#xFF0C;<code>lintOptions</code>&#x7684;<code>abortOnError</code>&#x53C2;&#x6570;&#x4E3A;<code>true</code>&#xFF0C;&#x5728;&#x6267;&#x884C;<code>lint</code>&#x547D;&#x4EE4;&#x65F6;&#xFF0C;&#x9047;&#x5230;&#x9519;&#x8BEF;&#x5373;&#x4E2D;&#x6B62;&#x6784;&#x5EFA;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x82E5;&#x5E0C;&#x671B;<code>lint</code>&#x6267;&#x884C;&#x51FA;&#x9519;&#x540E;&#x7EE7;&#x7EED;&#x6784;&#x5EFA;&#xFF0C;&#x5219;&#x9700;&#x8981;&#x5C06;&#x8BE5;&#x53C2;&#x6570;&#x7F6E;&#x4E3A;<code>false</code>&#xFF0C;&#x53EF;&#x4EE5;&#x5728;<code>build.gradle</code>&#x6587;&#x4EF6;&#x4E2D;&#x52A8;&#x6001;&#x4FEE;&#x6539;&#xFF1A;</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line">afterEvaluate { project -&gt;</div><div class="line">    <span class="keyword">if</span> (project.properties.containsKey(<span class="string">&apos;android&apos;</span>)) { <span class="comment">//&#x9488;&#x5BF9;android&#x5E94;&#x7528;&#x548C;android&#x5E93;&#x9879;&#x76EE;</span></div><div class="line">        project.android.lintOptions.abortOnError <span class="literal">false</span> <span class="comment">//&#x7981;&#x6B62;&#x9047;&#x5230;&#x9519;&#x8BEF;&#x4E2D;&#x6B62;&#x6784;&#x5EFA;  </span></div><div class="line">    }</div><div class="line">}</div><div class="line">...</div></pre></td></tr></table></figure>
<h4 id="1-2-3-FindBugs"><a href="#1-2-3-FindBugs" class="headerlink" title="1.2.3 FindBugs"></a>1.2.3 FindBugs</h4><p><a href="https://zh.wikipedia.org/wiki/FindBugs" target="_blank" rel="external">Findbugs</a>&#x662F;&#x4E00;&#x4E2A;&#x9759;&#x6001;&#x5206;&#x6790;&#x5DE5;&#x5177;&#xFF0C;&#x7528;&#x6765;&#x67E5;&#x627E;<code>Java</code>&#x4EE3;&#x7801;&#x4E2D;&#x7684;&#x7A0B;&#x5E8F;&#x9519;&#x8BEF;&#xFF0C;&#x5C06;&#x5B57;&#x8282;&#x7801;&#x4E0E;&#x4E00;&#x7EC4;&#x7F3A;&#x9677;&#x6A21;&#x5F0F;&#x8FDB;&#x884C;&#x5BF9;&#x6BD4;&#x4EE5;&#x53D1;&#x73B0;&#x53EF;&#x80FD;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5E76;&#x6839;&#x636E;&#x5176;&#x53EF;&#x80FD;&#x4EA7;&#x751F;&#x7684;&#x5F71;&#x54CD;&#x6216;&#x4E25;&#x91CD;&#x7A0B;&#x5EA6;&#xFF0C;&#x800C;&#x5BF9;&#x5F00;&#x53D1;&#x8005;&#x7684;&#x63D0;&#x793A;&#x3002;&#x5E76;&#x4E14;&#xFF0C;&#x8FD9;&#x7EC4;&#x7F3A;&#x9677;&#x6A21;&#x5F0F;&#x662F;&#x53EF;&#x914D;&#x7F6E;&#x7684;&#xFF0C;&#x901A;&#x8FC7;&#x914D;&#x7F6E;&#x53EF;&#x4EE5;&#x8FC7;&#x6EE4;&#x6389;&#x4E00;&#x4E9B;&#x6211;&#x4EEC;&#x4E0D;&#x60F3;&#x6216;&#x4E0D;&#x9700;&#x8981;&#x68C0;&#x6D4B;&#x7684;&#x95EE;&#x9898;&#x3002;</p>
<p><code>FindBugs</code>&#x548C;<code>Android Lint</code>&#x7684;&#x96C6;&#x6210;&#x65B9;&#x5F0F;&#x57FA;&#x672C;&#x4E00;&#x81F4;&#x3002;&#x5728;&#x5B89;&#x88C5;&#x63D2;&#x4EF6;<code>FindBugs Plugin</code>&#x540E;&#xFF0C;&#x8FDB;&#x5165;&#x9879;&#x76EE;&#x914D;&#x7F6E;&#x9875;&#xFF0C;&#x5E76;&#x6DFB;&#x52A0;&#x6784;&#x5EFA;&#x540E;&#x64CD;&#x4F5C;<code>Publish FindBugs analysis results</code>&#xFF0C;&#x6839;&#x636E;&#x9875;&#x9762;&#x63D0;&#x793A;&#x8BBE;&#x7F6E;&#x53C2;&#x6570;&#xFF0C;&#x82E5;&#x4E0D;&#x8BBE;&#x7F6E;&#x53C2;&#x6570;&#xFF0C;&#x5219;&#x4F7F;&#x7528;&#x9ED8;&#x8BA4;&#x53C2;&#x6570;&#x3002;&#x540C;&#x65F6;&#xFF0C;&#x5728;<code>Invoke Gradle Script</code>&#x7684;<code>Task</code>&#x4E2D;&#x6DFB;&#x52A0;&#x5BF9;&#x5E94;&#x7684;<code>findbugs</code>&#x68C0;&#x67E5;&#x4EFB;&#x52A1;&#x3002;</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//findbugs&#x63D2;&#x4EF6;</span></div><div class="line">apply <span class="string">plugin:</span> <span class="string">&apos;findbugs&apos;</span> </div><div class="line">task findbugs(<span class="string">type:</span> FindBugs, <span class="string">dependsOn:</span> <span class="string">&apos;assembleDebug&apos;</span>) {<span class="comment">//&#x4F9D;&#x8D56;Debug&#x6253;&#x5305;&#x6240;&#x4EA7;&#x751F;&#x7684;class&#x6587;&#x4EF6;</span></div><div class="line">    ...</div><div class="line">    excludeFilter = file(<span class="string">&quot;${project.rootDir}/configs/scripts/findbugs-filter.xml&quot;</span>) <span class="comment">//&#x914D;&#x7F6E;&#x8FC7;&#x6EE4;&#x6587;&#x4EF6;&#xFF0C;&#x51CF;&#x5C11;&#x4E0D;&#x5FC5;&#x8981;&#x7684;&#x68C0;&#x67E5;</span></div><div class="line">    classes = files(<span class="string">&quot;${project.buildDir}/intermediates/classes/&quot;</span>)<span class="comment">//&#x9ED8;&#x8BA4;&#x5206;&#x6790;&#x7684;class&#x6587;&#x4EF6;&#x5BF9;&#x8C61;</span></div><div class="line">    ...</div><div class="line">}</div></pre></td></tr></table></figure>
<p>&#x7ED3;&#x5408;<a href="https://github.com/jenkinsci/findbugs-plugin" target="_blank" rel="external">findbugs-plugin</a>&#x7684;&#x6E90;&#x7801;&#x53EF;&#x77E5;&#xFF0C;&#x53EA;&#x8981;&#x83B7;&#x53D6;<a href="https://github.com/jenkinsci/findbugs-plugin/blob/master/plugin/src/main/java/hudson/plugins/findbugs/FindBugsResultAction.java" target="_blank" rel="external">hudson.plugins.findbugs.FindBugsResultAction</a>&#x5BF9;&#x5E94;&#x7684;<code>Action</code>&#x5B9E;&#x4F8B;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x5F97;&#x5230;&#x5206;&#x6790;&#x7ED3;&#x679C;&#x3002;&#x6700;&#x540E;&#xFF0C;&#x5728;&#x90AE;&#x4EF6;&#x4E2D;&#x7684;&#x663E;&#x793A;&#x7ED3;&#x679C;&#x5982;&#x56FE;&#xFF1A;</p>
<p><img src="https://nos.netease.com/popo/743676cae801faeb937ab0e828fb4476.jpg" alt=""></p>
<p>&#x70B9;&#x51FB;&#x94FE;&#x63A5;&#x5730;&#x5740;&#xFF0C;&#x540C;&#x6837;&#x8DF3;&#x8F6C;&#x5230;<code>FindBugs</code>&#x7684;&#x56FE;&#x6587;&#x754C;&#x9762;&#x3002;</p>
<p><img src="https://nos.netease.com/popo/610530e913c4ab0f321321c359ea9f53.jpg" alt=""></p>
<h6 id="&#x52A8;&#x6001;&#x96C6;&#x6210;&#x81EA;&#x5B9A;&#x4E49;&#x7684;gradle&#x4EFB;&#x52A1;&#x65B9;&#x6848;"><a href="#&#x52A8;&#x6001;&#x96C6;&#x6210;&#x81EA;&#x5B9A;&#x4E49;&#x7684;gradle&#x4EFB;&#x52A1;&#x65B9;&#x6848;" class="headerlink" title="&#x52A8;&#x6001;&#x96C6;&#x6210;&#x81EA;&#x5B9A;&#x4E49;&#x7684;gradle&#x4EFB;&#x52A1;&#x65B9;&#x6848;"></a>&#x52A8;&#x6001;&#x96C6;&#x6210;&#x81EA;&#x5B9A;&#x4E49;&#x7684;gradle&#x4EFB;&#x52A1;&#x65B9;&#x6848;</h6><p>&#x5728;&#x9879;&#x76EE;&#x6301;&#x7EED;&#x96C6;&#x6210;&#x65F6;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x6DFB;&#x52A0;&#x4E00;&#x4E9B;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x4EFB;&#x52A1;&#xFF0C;&#x4F46;&#x662F;&#x53C8;&#x8981;&#x5C3D;&#x91CF;&#x907F;&#x514D;&#x4FEE;&#x6539;&#x7528;&#x6237;&#x7684;&#x9879;&#x76EE;&#x4EE3;&#x7801;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x672C;&#x6587;&#x91C7;&#x7528;&#x4E86;&#x4E00;&#x4E2A;&#x6BD4;&#x8F83;&#x6298;&#x4E2D;&#x7684;&#x65B9;&#x6848;&#xFF1A;<br>&#x5728;<code>Jenkins</code>&#x7684;&#x6839;&#x76EE;&#x5F55;&#x4E0B;&#x5EFA;&#x4E00;&#x4E2A;<code>configs</code>&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x653E;&#x7F6E;&#x4E00;&#x4E9B;&#x9879;&#x76EE;&#x6784;&#x5EFA;&#x8FC7;&#x7A0B;&#x4F7F;&#x7528;&#x7684;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;&#x3001;&#x811A;&#x672C;&#x4EE5;&#x53CA;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x7B49;&#xFF1B;&#x7136;&#x540E;&#x5728;&#x9879;&#x76EE;&#x6784;&#x5EFA;&#x4E4B;&#x524D;&#xFF0C;&#x901A;&#x8FC7;&#x6267;&#x884C;<code>Job</code>&#x914D;&#x7F6E;&#x9875;&#x7684;&#x811A;&#x672C;&#x5C06;&#x8BE5;&#x6587;&#x4EF6;&#x5939;&#x53CA;&#x5176;&#x5185;&#x5BB9;&#x590D;&#x5236;&#x5230;&#x76EE;&#x6807;&#x6784;&#x5EFA;&#x9879;&#x76EE;&#x7684;&#x5DE5;&#x4F5C;&#x7A7A;&#x95F4;&#x4E2D;&#xFF0C;&#x540C;&#x65F6;&#x4FEE;&#x6539;&#x9879;&#x76EE;&#x7684;<code>build.gradle</code>&#x6587;&#x4EF6;&#xFF1B;&#x6700;&#x540E;&#x5728;&#x9879;&#x76EE;&#x6784;&#x5EFA;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x8C03;&#x7528;&#x8FD9;&#x4E9B;&#x7B2C;&#x4E09;&#x65B9;&#x5E93;&#x3001;&#x811A;&#x672C;&#x4EE5;&#x53CA;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x6765;&#x5B8C;&#x6210;&#x81EA;&#x5B9A;&#x4E49;&#x7684;&#x989D;&#x5916;&#x7684;&#x6784;&#x5EFA;&#x4EFB;&#x52A1;&#x3002;</p>
<p><code>FindBugs</code>&#x4EFB;&#x52A1;&#x7684;&#x96C6;&#x6210;&#x5C31;&#x5E94;&#x7528;&#x4E86;&#x4E0A;&#x8FF0;&#x65B9;&#x6848;&#xFF0C;&#x540E;&#x7EED;&#x4ECB;&#x7ECD;&#x7684;<code>FireLine</code>&#x96C6;&#x6210;&#x4EE5;&#x53CA;<code>Apk</code>&#x5927;&#x5C0F;&#x3001;&#x65B9;&#x6CD5;&#x6570;&#x548C;&#x8D44;&#x6E90;&#x6587;&#x4EF6;&#x7EDF;&#x8BA1;&#x7684;&#x96C6;&#x6210;&#x4EA6;&#x662F;&#x5982;&#x6B64;&#x3002;</p>
<p>&#x4F8B;&#x5982;&#xFF0C;&#x4FEE;&#x6539;<code>build.gradle</code>&#x6587;&#x4EF6;&#xFF0C;&#x52A8;&#x6001;&#x5F15;&#x5165;<code>jenkins.gradle</code>&#x6587;&#x4EF6;&#xFF1A;</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">project(<span class="string">&apos;:app&apos;</span>) { <span class="comment">//&#x5728;&#x9879;&#x76EE;&#x7684;&#x4E3B;moudle&#xFF08;&#x4E00;&#x822C;&#x9ED8;&#x8BA4;&#x662F;app&#xFF09;&#x4E2D;&#x5F15;&#x7528;&#x6784;&#x5EFA;&#x76F8;&#x5173;&#x7684;gradle&#x811A;&#x672C;</span></div><div class="line">    apply <span class="string">from:</span> rootProject.getRootDir().getAbsolutePath() + <span class="string">&apos;/configs/scripts/jenkins.gradle&apos;</span></div><div class="line">    ...</div><div class="line">}</div></pre></td></tr></table></figure>
<h4 id="1-2-4-FireLine"><a href="#1-2-4-FireLine" class="headerlink" title="1.2.4 FireLine"></a>1.2.4 FireLine</h4><p><a href="http://magic.360.cn/index.html" target="_blank" rel="external">&#x706B;&#x7EBF;</a>&#xFF08;<code>FireLine</code>&#xFF09;&#x63D0;&#x4F9B;&#x4E00;&#x79CD;&#x9759;&#x6001;&#x4EE3;&#x7801;&#xFF08;&#x6307;<code>java</code>&#x6E90;&#x7801;&#xFF0C;&#x540E;&#x6765;&#x636E;&#x8BF4;&#x53C8;&#x652F;&#x6301;<code>class</code>&#x6587;&#x4EF6;&#xFF09;&#x626B;&#x63CF;&#x670D;&#x52A1;&#xFF0C;&#x57FA;&#x4E8E;<code>PMD</code>&#x5F00;&#x6E90;&#x3002;&#x5B83;&#x662F;360&#x516C;&#x53F8;&#x9488;&#x5BF9;&#x81EA;&#x5DF1;&#x7684;&#x4EA7;&#x54C1;&#x5B9A;&#x5236;&#x7684;&#x5B89;&#x5168;&#x68C0;&#x67E5;&#x89C4;&#x5219;&#xFF0C;&#x4F7F;&#x7528;&#x8FD9;&#x4E9B;&#x89C4;&#x5219;&#x5BF9;&#x6E90;&#x4EE3;&#x7801;&#x8FDB;&#x884C;&#x626B;&#x63CF;&#x68C0;&#x6D4B;&#xFF0C;&#x627E;&#x51FA;&#x4EE3;&#x7801;&#x6F5C;&#x5728;&#x7684;&#x5B89;&#x5168;&#x98CE;&#x9669;&#x3002;&#x76EE;&#x524D;&#xFF0C;&#x5BF9;&#x5916;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x672C;&#x6587;&#x5BF9;&#x8BE5;&#x5DE5;&#x5177;&#x8FDB;&#x884C;&#x4E86;&#x96C6;&#x6210;&#x3002;</p>
<p><code>FireLine</code>&#x5BF9;&#x5916;&#x63D0;&#x4F9B;&#x4E00;&#x4E2A;<code>jar</code>&#x5305;&#xFF0C;&#x5FC5;&#x987B;&#x901A;&#x8FC7;&#x547D;&#x4EE4;&#x884C;&#x7684;&#x5F62;&#x5F0F;&#x8FD0;&#x884C;&#xFF0C;&#x56E0;&#x6B64;&#x9700;&#x8981;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;<code>fireLine</code>&#x7684;&#x4EFB;&#x52A1;&#xFF1A;</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//&#x626B;&#x63CF;java&#x6E90;&#x7801;&#xFF0C;&#x9700;&#x6307;&#x5B9A;&#x626B;&#x63CF;&#x5BF9;&#x8C61;&#x4EE5;&#x53CA;&#x7ED3;&#x679C;&#x5B58;&#x50A8;&#x4F4D;&#x7F6E;</span></div><div class="line">task fireLine &lt;&lt; {</div><div class="line">    <span class="keyword">def</span> fireLineDir=env.JENKINS_HOME+<span class="string">&quot;/jobs/&quot;</span>+env.JOB_NAME+<span class="string">&quot;/builds/&quot;</span>+env.BUILD_NUMBER+<span class="string">&quot;/&quot;</span></div><div class="line">    exec {</div><div class="line">        workingDir <span class="string">&apos;./&apos;</span></div><div class="line">        <span class="comment">//&#x547D;&#x4EE4;&#x884C;&#x6267;&#x884C;jar&#x5305;</span></div><div class="line">        commandLine <span class="string">&quot;java&quot;</span>, <span class="string">&quot;-jar&quot;</span>, <span class="string">&quot;${project.rootDir}/configs/jars/fireline.jar&quot;</span>, <span class="string">&quot;scanSrcDir=&quot;</span>+env.WORKSPACE, <span class="string">&quot;reportSaveDir=&quot;</span>+fireLineDir,<span class="string">&quot;reportFileName=fireLineResult&quot;</span>,<span class="string">&quot;user=netease&quot;</span></div><div class="line">    }</div><div class="line">    ...</div><div class="line">}</div></pre></td></tr></table></figure>
<p>&#x6784;&#x5EFA;&#x540E;&#xFF0C;&#x68C0;&#x67E5;&#x7ED3;&#x679C;&#x5728;&#x90AE;&#x4EF6;&#x4E2D;&#x663E;&#x793A;&#x5982;&#x56FE;&#xFF1A;</p>
<p><img src="https://nos.netease.com/popo/70d4c25e2675849aa5b760c258ad655e.jpg" alt=""></p>
<p>&#x70B9;&#x51FB;&#x94FE;&#x63A5;&#x5730;&#x5740;&#xFF0C;&#x8DF3;&#x8F6C;&#x5230;&#x9700;&#x8981;<code>HTML Publisher Plugin</code>&#x652F;&#x6301;&#x7684;&#x706B;&#x7EBF;&#x68C0;&#x67E5;&#x7684;&#x8BE6;&#x7EC6;&#x754C;&#x9762;&#xFF1A;</p>
<p><img src="https://nos.netease.com/popo/8ad710117b1e3f862f24d23b783fde84.jpg" alt=""></p>
<p>&#x6CE8;&#x610F;&#xFF0C;&#x82E5;<code>FireLine</code>&#x62A5;&#x544A;&#x4E0D;&#x80FD;&#x6B63;&#x5E38;&#x663E;&#x793A;&#xFF0C;&#x8FD9;&#x662F;&#x7531;&#x4E8E;&#x5B83;&#x4F7F;&#x7528;&#x4E86;<code>JavaScript</code>&#xFF0C;&#x8FD9;&#x91CC;&#x9700;&#x8981;&#x8BBE;&#x7F6E;<code>jenkins</code>&#x5141;&#x8BB8;&#x811A;&#x672C;&#x6267;&#x884C;&#xFF08;<code>allow-scripts</code>&#xFF09;&#xFF0C;&#x9700;&#x8981;&#x5728;&#x7CFB;&#x7EDF;&#x8BBE;&#x7F6E;&#x9875;&#x7684;<code>Jenkins Script Console</code>&#x9009;&#x9879;&#x4E2D;&#x8F93;&#x5165;&#x547D;&#x4EE4;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"> System.setProperty(&quot;hudson.model.DirectoryBrowserSupport.CSP&quot;, &quot;&quot;) </div><div class="line">``` </div><div class="line"></div><div class="line">&#x5E76;&#x6267;&#x884C;&#xFF0C;&#x4ECE;&#x800C;&#x4FEE;&#x6539;`Jenkins`&#x7684;&#x9ED8;&#x8BA4;&#x914D;&#x7F6E;&#x53C2;&#x6570;&#xFF0C;&#x7136;&#x540E;&#x91CD;&#x65B0;&#x6784;&#x5EFA;&#x9879;&#x76EE;&#x5373;&#x53EF;&#xFF0C;&#x8BE6;&#x7EC6;&#x95EE;&#x9898;&#x53EF;&#x53C2;&#x8003;`stackoverflow`&#x4E0A;&#x7684;&#x56DE;&#x7B54;[the &apos;allow-scripts&apos; permission is not set](http://stackoverflow.com/questions/34315723/blocked-script-execution-in-url-because-the-documents-frame-is-sandboxed-and)&#x3002;</div><div class="line"></div><div class="line">#### 1.2.5 Apk&#x65B9;&#x6CD5;&#x6570;&#x3001;&#x5927;&#x5C0F;&#x4EE5;&#x53CA;&#x8D44;&#x6E90;&#x6587;&#x4EF6;&#x5206;&#x6790;</div><div class="line">&#x968F;&#x7740;&#x9879;&#x76EE;&#x7684;&#x4E0D;&#x65AD;&#x8FED;&#x4EE3;&#x66F4;&#x65B0;&#xFF0C;`android`&#x5E94;&#x7528;&#x4E0D;&#x5F97;&#x4E0D;&#x9762;&#x5BF9;`64k`&#x65B9;&#x6CD5;&#x6570;&#x9650;&#x5236;&#x3001;`Apk`&#x4F53;&#x79EF;&#x4E0D;&#x65AD;&#x53D8;&#x5927;&#x7684;&#x95EE;&#x9898;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x672C;&#x6B21;&#x5B9E;&#x8DF5;&#x4E2D;&#x5C06;&#x5BF9;&#x8BE5;&#x7C7B;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x6536;&#x96C6;&#x5206;&#x6790;&#xFF0C;&#x66F4;&#x52A0;&#x76F4;&#x89C2;&#x7684;&#x5C55;&#x73B0;&#x7ED9;&#x5173;&#x6CE8;&#x8BE5;&#x7C7B;&#x4FE1;&#x606F;&#x7684;&#x7528;&#x6237;&#x3002;</div><div class="line">######  Apk&#x65B9;&#x6CD5;&#x6570;&#x3001;&#x5927;&#x5C0F;&#x7EDF;&#x8BA1;</div><div class="line">&#x5728;`Apk`&#x65B9;&#x6CD5;&#x6570;&#x7EDF;&#x8BA1;&#x96C6;&#x6210;&#x4E2D;&#xFF0C;&#x91C7;&#x7528;&#x4E86;&#x5F00;&#x6E90;&#x7684;`Gradle`&#x63D2;&#x4EF6;&#x9879;&#x76EE;-[dexcount-gradle-plugin](https://github.com/KeepSafe/dexcount-gradle-plugin)&#xFF0C;&#x8BE5;&#x63D2;&#x4EF6;&#x4F1A;&#x6839;&#x636E;&#x914D;&#x7F6E;&#x4E3A;&#x6253;&#x5305;&#x7684;&#x6BCF;&#x4E2A;`Apk`&#x6587;&#x4EF6;&#x751F;&#x6210;&#x4E00;&#x4EFD;&#x65B9;&#x6CD5;&#x6570;&#x7EDF;&#x8BA1;&#x7684;&#x6587;&#x4EF6;&#x3002;</div><div class="line"></div><div class="line">```groovy</div><div class="line">buildscript {</div><div class="line">    repositories {</div><div class="line">        mavenCentral() // or jcenter()</div><div class="line">    }</div><div class="line">    dependencies {</div><div class="line">        classpath &apos;com.getkeepsafe.dexcount:dexcount-gradle-plugin:0.6.1&apos;</div><div class="line">    }</div><div class="line">}</div><div class="line"></div><div class="line">// make sure this line comes *after* you apply the Android plugin</div><div class="line">apply plugin: &apos;com.getkeepsafe.dexcount&apos;</div></pre></td></tr></table></figure>
<p>&#x914D;&#x7F6E;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x6267;&#x884C;<code>assemble</code>&#x4EFB;&#x52A1;&#x65F6;&#xFF0C;&#x4F1A;&#x5728;<code>app/build/outputs</code>&#x76EE;&#x5F55;&#x4E0B;&#x751F;&#x6210;<code>apk</code>&#x65B9;&#x6CD5;&#x6570;&#x7EDF;&#x8BA1;&#x6570;&#x636E;&#x6587;&#x4EF6;&#xFF1A;</p>
<p><img src="https://nos.netease.com/popo/c139efda8d19abae9869aadc6fdb044b.jpg" alt=""></p>
<p>&#x56E0;&#x6B64;&#xFF0C;&#x5728;&#x672C;&#x6B21;<code>jenkins-ci</code>&#x5B9E;&#x8DF5;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x505A;&#x5C31;&#x662F;&#x5728;&#x6784;&#x5EFA;&#x9879;&#x76EE;&#x4E2D;&#x52A8;&#x6001;&#x6DFB;&#x52A0;&#x8BE5;&#x63D2;&#x4EF6;&#xFF0C;&#x5E76;&#x5C06;&#x8BE5;&#x63D2;&#x4EF6;&#x751F;&#x6210;&#x7684;&#x7EDF;&#x8BA1;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x6536;&#x96C6;&#x3001;&#x8F6C;&#x6362;&#x3002;</p>
<p>&#x548C;&#x96C6;&#x6210;<code>findbugs</code>&#x63D2;&#x4EF6;&#x4E0D;&#x540C;&#x7684;&#x662F;&#xFF0C;&#x8FD9;&#x91CC;&#x8FD8;&#x9700;&#x8981;&#x52A8;&#x6001;&#x4FEE;&#x6539;<code>app</code>&#x9879;&#x76EE;&#x7684;<code>buildscript</code>&#x5BF9;&#x8C61;&#xFF0C;&#x5E76;&#x4FDD;&#x8BC1;&#x8BE5;&#x63D2;&#x4EF6;&#x662F;&#x5728;<code>com.android.application</code>&#x4E4B;&#x540E;&#x88AB;&#x5E94;&#x7528;&#x3002;</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//&#x52A8;&#x6001;&#x4FEE;&#x6539;`app`&#x9879;&#x76EE;&#x7684;`buildscript`&#x5BF9;&#x8C61;</span></div><div class="line">project(<span class="string">&apos;:app&apos;</span>) {</div><div class="line">    apply <span class="string">from:</span> rootProject.getRootDir().getAbsolutePath() + <span class="string">&apos;/configs/scripts/buildscript.gradle&apos;</span>, <span class="string">to:</span> buildscript</div><div class="line">    ...</div><div class="line">}</div></pre></td></tr></table></figure>
<p>&#x5E76;&#x901A;&#x8FC7;&#x8C03;&#x7528;<code>gradle</code>&#x4E2D;&#x7684;<code>PluginManager</code>&#x5BF9;&#x8C61;&#x7684;<code>void withPlugin(String id, Action&lt;? super AppliedPlugin&gt; action)</code>&#x65B9;&#x6CD5;&#xFF0C;&#x6765;&#x76D1;&#x542C;&#x63D2;&#x4EF6;&#x7684;&#x6DFB;&#x52A0;&#x4E8B;&#x4EF6;&#x3002;&#x5F53;<code>com.android.application</code>&#x63D2;&#x4EF6;&#x88AB;&#x6DFB;&#x52A0;&#x65F6;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x52A8;&#x6001;&#x6DFB;&#x52A0;<code>dexcount-gradle-plugin</code>&#x63D2;&#x4EF6;&#x3002;</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">pluginManager.withPlugin(<span class="string">&quot;com.android.application&quot;</span>, <span class="keyword">new</span> Action&lt;AppliedPlugin&gt;() {</div><div class="line">    <span class="keyword">void</span> execute(AppliedPlugin appliedPlugin) {</div><div class="line">        project(<span class="string">&apos;:app&apos;</span>) { <span class="comment">//&#x4E3B;module&#x540D;&#x79F0;</span></div><div class="line">            apply <span class="string">plugin:</span> <span class="string">&apos;com.getkeepsafe.dexcount&apos;</span> <span class="comment">//&#x5F15;&#x5165;apk&#x65B9;&#x6CD5;&#x6570;&#x7EDF;&#x8BA1;&#x63D2;&#x4EF6;</span></div><div class="line">            apply <span class="string">plugin:</span> <span class="string">&quot;com.netease.hearttouch.resourcesize&quot;</span> <span class="comment">//&#x5F15;&#x5165;&#x8D44;&#x6E90;&#x6587;&#x4EF6;&#x7EDF;&#x8BA1;&#x63D2;&#x4EF6;</span></div><div class="line">            ...</div><div class="line">        }</div><div class="line">    }</div><div class="line">})</div></pre></td></tr></table></figure>
<p>&#x6700;&#x540E;&#xFF0C;&#x4E3A;&#x4E86;&#x5728;<code>jenkins</code>&#x4E2D;&#x4F7F;&#x7528;&#x8BE5;&#x6570;&#x636E;&#xFF0C;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;<code>apkMethodCounts</code>&#x4EFB;&#x52A1;&#x5C06;&#x4E0A;&#x8FF0;&#x7684;&#x6240;&#x6709;&#x7684;<code>json</code>&#x683C;&#x5F0F;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x7EDF;&#x4E00;&#x89E3;&#x6790;&#x8F6C;&#x6362;&#xFF0C;&#x5E76;&#x5C06;&#x89E3;&#x6790;&#x7ED3;&#x679C;&#x548C;&#x751F;&#x6210;&#x7684;<code>Apk</code>&#x6587;&#x4EF6;&#x2013;&#x5BF9;&#x5E94;&#x8D77;&#x6765;&#x3002;&#x6784;&#x5EFA;&#x7ED3;&#x679C;&#x5982;&#x56FE;&#xFF1A;</p>
<p><img src="https://nos.netease.com/popo/ab6fd8a20b0836902c48f3d02ddec216.jpg" alt=""></p>
<h6 id="&#x8D44;&#x6E90;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x7EDF;&#x8BA1;"><a href="#&#x8D44;&#x6E90;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x7EDF;&#x8BA1;" class="headerlink" title="&#x8D44;&#x6E90;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x7EDF;&#x8BA1;"></a>&#x8D44;&#x6E90;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#x7EDF;&#x8BA1;</h6><p>&#x8D44;&#x6E90;&#x6587;&#x4EF6;&#x7EDF;&#x8BA1;&#x63D2;&#x4EF6;<a href="https://g.hz.netease.com/hearttouch-android/resource_size_plugin" target="_blank" rel="external">resource-size-plugin</a>&#x4E0E;<code>dexcount-gradle-plugin</code>&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;&#x57FA;&#x672C;&#x4E00;&#x81F4;&#xFF0C;&#x8BE5;&#x63D2;&#x4EF6;&#x4E5F;&#x662F;&#x9700;&#x8981;&#x901A;&#x8FC7;&#x52A8;&#x6001;&#x6DFB;&#x52A0;&#x3002;</p>
<p>&#x63D2;&#x4EF6;&#x914D;&#x7F6E;&#x5B8C;&#x6210;&#x540E;&#xFF0C;&#x6267;&#x884C;<code>resourcesize</code>&#x4EFB;&#x52A1;&#xFF0C;&#x4F1A;&#x5728;<code>app/build/outputs</code>&#x76EE;&#x5F55;&#x4E0B;&#x751F;&#x6210;&#x5206;&#x6790;&#x7ED3;&#x679C;<code>resoucesize.txt</code>&#x3002;&#x5176;&#x4E2D;&#xFF0C;&#x7B2C;&#x4E00;&#x884C;&#x8868;&#x793A;&#x6240;&#x6709;&#x8D44;&#x6E90;&#x6587;&#x4EF6;&#x7684;&#x603B;&#x5927;&#x5C0F;&#xFF0C;&#x540E;&#x9762;&#x6BCF;&#x884C;&#x4EE3;&#x8868;&#x5355;&#x4E2A;&#x6587;&#x4EF6;&#x6700;&#x5927;&#x7684;&#x6587;&#x4EF6;&#x540D;&#x79F0;&#x4EE5;&#x53CA;&#x6587;&#x4EF6;&#x5927;&#x5C0F;&#xFF1A;</p>
<p><img src="https://nos.netease.com/popo/d900de430614c344379c01aad3af8c98.jpg?imageView&amp;thumbnail=500x300" alt=""></p>
<p>&#x6700;&#x540E;&#xFF0C;&#x5C06;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x7B80;&#x5355;&#x5904;&#x7406;&#xFF0C;&#x5728;<code>jenkins</code>&#x7684;&#x6784;&#x5EFA;&#x7ED3;&#x679C;&#x4E2D;&#x663E;&#x793A;&#x5982;&#x56FE;&#xFF1A;</p>
<p><img src="https://nos.netease.com/popo/5571e696f32a9e23bf86ce558ab0d22a.jpg?imageView&amp;thumbnail=0x400" alt=""></p>
<h4 id="1-2-6-Git-Changelog&#x5206;&#x6790;"><a href="#1-2-6-Git-Changelog&#x5206;&#x6790;" class="headerlink" title="1.2.6 Git Changelog&#x5206;&#x6790;"></a>1.2.6 Git Changelog&#x5206;&#x6790;</h4><p>&#x968F;&#x7740;&#x9879;&#x76EE;&#x7684;&#x8FED;&#x4EE3;&#xFF0C;&#x4EE3;&#x7801;&#x7684;&#x63D0;&#x4EA4;&#x8D8A;&#x6765;&#x8D8A;&#x9891;&#x7E41;&#xFF0C;&#x4EE3;&#x7801;&#x7684;&#x7BA1;&#x7406;&#x663E;&#x5F97;&#x8D8A;&#x6765;&#x8D8A;&#x91CD;&#x8981;&#x3002;&#x800C;<code>commit message</code>&#x662F;&#x5F00;&#x53D1;&#x8005;&#x662F;&#x5BF9;&#x81EA;&#x5DF1;&#x6240;&#x63D0;&#x4EA4;&#x4EE3;&#x7801;&#x7684;&#x552F;&#x4E00;&#x8BF4;&#x660E;&#xFF0C;&#x5B83;&#x80FD;&#x591F;&#x76F4;&#x63A5;&#x53CD;&#x6620;&#x5F00;&#x53D1;&#x8005;&#x7684;&#x610F;&#x56FE;&#xFF0C;&#x5E76;&#x65B9;&#x4FBF;&#x5FEB;&#x901F;&#x67E5;&#x8BE2;&#x548C;&#x6D4F;&#x89C8;&#xFF0C;&#x662F;&#x5FC5;&#x4E0D;&#x53EF;&#x5C11;&#x7684;&#x3002;&#x5728;&#x8FD9;&#x4E9B;<code>commit message</code>&#x4E2D;&#xFF0C;&#x6BD4;&#x8F83;&#x91CD;&#x8981;&#x7684;&#x4E3B;&#x8981;&#x6709;<code>feature</code>&#xFF08;&#x65B0;&#x529F;&#x80FD;&#xFF09;&#x548C;<code>bug fix</code>&#xFF08;&#x95EE;&#x9898;&#x4FEE;&#x590D;&#xFF09;&#x4E24;&#x79CD;&#x7C7B;&#x578B;&#xFF0C;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x4EA7;&#x54C1;&#x7684;&#x5173;&#x6CE8;&#x70B9;&#x3002;</p>
<p>&#x56E0;&#x6B64;&#xFF0C;&#x4E3A;&#x4E86;&#x5728;&#x6784;&#x5EFA;&#x4E2D;&#x63D0;&#x53D6;&#x8BE5;&#x7C7B;&#x4FE1;&#x606F;&#xFF0C;&#x5728;&#x53C2;&#x8003;&#x7F51;&#x4E0A;&#x7684;&#x4E00;&#x4E9B;<code>Git</code>&#x89C4;&#x8303;&#x7684;&#x57FA;&#x7840;&#x4E0A;&#xFF0C;&#x6574;&#x7406;&#x51FA;&#x4E00;&#x4EFD;<a href="https://g.hz.netease.com/mobile-android/document/blob/master/%E8%A7%84%E8%8C%83/git%E6%97%A5%E5%BF%97:%E5%88%86%E6%94%AF%E8%A7%84%E8%8C%83.md" target="_blank" rel="external">Git&#x63D0;&#x4EA4;&#x89C4;&#x8303;</a>&#xFF0C;&#x89C4;&#x5B9A;&#x4E86;&#x5B8C;&#x6574;&#x7684;<code>git</code>&#x63D0;&#x4EA4;&#x65E5;&#x5FD7;&#x7531;&#x4FE1;&#x606F;&#x5934;&#x90E8;&#x3001;&#x4FE1;&#x606F;&#x4E3B;&#x4F53;&#x548C;&#x4FE1;&#x606F;&#x5C3E;&#x90E8;&#x6784;&#x6210;&#xFF0C;&#x5176;&#x4E2D;&#x4FE1;&#x606F;&#x5934;&#x90E8;&#x9700;&#x8981;&#x5305;&#x542B;&#x7C7B;&#x578B;&#x3001;&#x8303;&#x56F4;&#x548C;&#x4E3B;&#x9898;&#x4E09;&#x7C7B;&#x4FE1;&#x606F;&#x3002;</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">type</span>&gt;</span>(<span class="tag">&lt;<span class="name">scope</span>&gt;</span>):<span class="tag">&lt;<span class="name">subject</span>&gt;</span></div><div class="line"> &#x7A7A;&#x884C;</div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"> &#x7A7A;&#x884C;</div><div class="line"><span class="tag">&lt;<span class="name">footer</span>&gt;</span></div></pre></td></tr></table></figure>
<p>&#x8BE6;&#x7EC6;&#x89C4;&#x8303;&#x63CF;&#x8FF0;&#x53EF;&#x53C2;&#x8003;<a href="https://g.hz.netease.com/mobile-android/document/blob/master/%E8%A7%84%E8%8C%83/git%E6%97%A5%E5%BF%97:%E5%88%86%E6%94%AF%E8%A7%84%E8%8C%83.md" target="_blank" rel="external">&#x89C4;&#x8303;&#x6587;&#x6863;</a>&#x3002;&#x53E6;&#x5916;&#xFF0C;<a href="https://github.com/commitizen/cz-cli" target="_blank" rel="external">Commitizen</a>&#x662F;&#x4E00;&#x4E2A;&#x64B0;&#x5199;&#x5408;&#x683C;<code>Commit message</code>&#x7684;&#x5DE5;&#x5177;&#xFF0C;&#x5F88;&#x597D;&#x7528;&#xFF0C;&#x63A8;&#x8350;&#xFF5E;&#x3002;&#x4F7F;&#x7528;&#x8BE5;&#x5DE5;&#x63D0;&#x4EA4;&#x4EE3;&#x7801;&#x4E4B;&#x540E;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x751F;&#x6210;&#x4E0A;&#x8FF0;&#x683C;&#x5F0F;&#x89C4;&#x8303;&#x7684;&#x65E5;&#x5FD7;&#x4FE1;&#x606F;&#x3002;</p>
<p>&#x901A;&#x8FC7;<code>Commitizen</code>&#x5DE5;&#x5177;&#xFF08;&#x6216;&#x8005;&#x624B;&#x52A8;&#xFF09;&#x63D0;&#x4EA4;&#x4E4B;&#x540E;&#xFF0C;&#x5728;<code>GitLab</code>&#x4E0A;&#x751F;&#x6210;&#x7684;<code>Commit message</code>&#x5982;&#x56FE;&#xFF1A;</p>
<p><img src="https://nos.netease.com/popo/1de9a4ecf80b34eefcbfcaed7d8f271e.jpg" alt=""></p>
<p>&#x4ECE;&#x56FE;&#x4E2D;&#x7684;&#x793A;&#x4F8B;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#xFF0C;&#x4E24;&#x4E2A;<code>Commit message</code>&#x7684;&#x7C7B;&#x578B;&#x662F;<code>feature</code>&#x548C;<code>bug fix</code>&#x7684;&#xFF0C;&#x56E0;&#x6B64;<code>Jenkins</code>&#x6784;&#x5EFA;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x9700;&#x8981;&#x8FDB;&#x884C;&#x5904;&#x7406;&#x5E76;&#x663E;&#x793A;&#x7ED9;&#x7528;&#x6237;&#x3002;<br>&#xFFFC;<br><img src="https://nos.netease.com/popo/f4d85368b1fdf419de676e7dec91aac4.jpg" alt=""></p>
<p>&#x53E6;&#x5916;&#xFF0C;&#x4E3A;&#x4E86;&#x80FD;&#x591F;&#x89E3;&#x6790;<code>bug fix</code>&#x7C7B;&#x578B;&#x63D0;&#x4EA4;&#x4E2D;&#x7684;<code>jira</code>&#x4E0A;&#x7684;&#x95EE;&#x9898;&#x5E76;&#x751F;&#x6210;&#x8DF3;&#x8F6C;&#x94FE;&#x63A5;&#xFF0C;&#x9700;&#x8981;&#x5728;&#x9879;&#x76EE;&#x6839;&#x76EE;&#x5F55;&#x4E0B;&#x6DFB;&#x52A0;&#x4E00;&#x4E2A;<code>jenkins.xml</code>&#x6587;&#x4EF6;&#xFF0C;&#x793A;&#x4F8B;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">jenkins</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">jira</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>http://jira.netease.com/projects/MINIFIVE/issues/MINIFIVE-#<span class="tag">&lt;/<span class="name">url</span>&gt;</span> <span class="comment">&lt;!--#&#x4F5C;&#x4E3A;&#x5360;&#x4F4D;&#x7B26;--&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">jira</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">jenkins</span>&gt;</span></div></pre></td></tr></table></figure>
<p>&#x7EFC;&#x4E0A;&#xFF0C;&#x5173;&#x4E8E;&#x81EA;&#x5B9A;&#x4E49;<code>Jenkins-ci</code>&#x6784;&#x5EFA;&#x901A;&#x77E5;&#x90AE;&#x4EF6;&#x5185;&#x5BB9;&#x7684;&#x90E8;&#x5206;&#x5DF2;&#x7ECF;&#x4ECB;&#x7ECD;&#x5B8C;&#x4E86;&#xFF0C;&#x4E0B;&#x9762;&#x6211;&#x4EEC;&#x8981;&#x8BB2;&#x4E00;&#x4E0B;<code>Jenkins</code>&#x4E0E;<code>Docker</code>&#x7ED3;&#x5408;&#x5982;&#x4F55;&#x5B9E;&#x73B0;&#x5FEB;&#x901F;&#x914D;&#x7F6E;&#x3002;</p>
<h2 id="2-Jenkins&#x4E0E;Docker&#x7ED3;&#x5408;&#x5B9E;&#x73B0;&#x5FEB;&#x901F;&#x914D;&#x7F6E;"><a href="#2-Jenkins&#x4E0E;Docker&#x7ED3;&#x5408;&#x5B9E;&#x73B0;&#x5FEB;&#x901F;&#x914D;&#x7F6E;" class="headerlink" title="2 Jenkins&#x4E0E;Docker&#x7ED3;&#x5408;&#x5B9E;&#x73B0;&#x5FEB;&#x901F;&#x914D;&#x7F6E;"></a>2 Jenkins&#x4E0E;Docker&#x7ED3;&#x5408;&#x5B9E;&#x73B0;&#x5FEB;&#x901F;&#x914D;&#x7F6E;</h2><p><a href="https://www.docker.com/" target="_blank" rel="external">Docker</a>&#x662F;&#x4E00;&#x4E2A;&#x5F00;&#x6E90;&#x7684;&#x5E94;&#x7528;&#x5BB9;&#x5668;&#x5F15;&#x64CE;&#xFF0C;&#x8BA9;&#x5F00;&#x53D1;&#x8005;&#x53EF;&#x4EE5;&#x6253;&#x5305;&#x4ED6;&#x4EEC;&#x7684;&#x5E94;&#x7528;&#x4EE5;&#x53CA;&#x4F9D;&#x8D56;&#x5305;&#x5230;&#x4E00;&#x4E2A;&#x53EF;&#x79FB;&#x690D;&#x7684;&#x5BB9;&#x5668;&#x4E2D;&#xFF0C;&#x7136;&#x540E;&#x53D1;&#x5E03;&#x5230;&#x4EFB;&#x4F55;&#x6D41;&#x884C;&#x7684;<code>Linux</code>&#x673A;&#x5668;&#x4E0A;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5B9E;&#x73B0;&#x865A;&#x62DF;&#x5316;&#x3002;&#x57FA;&#x4E8E;<code>Docker</code>&#x8F7B;&#x91CF;&#x7EA7;&#x3001;&#x53EF;&#x79FB;&#x690D;&#x7684;&#x7279;&#x70B9;&#xFF0C;&#x672C;&#x6B21;&#x5B9E;&#x8DF5;&#x5C06;<code>Jenkins-ci</code>&#x7684;&#x6784;&#x5EFA;&#x73AF;&#x5883;&#x914D;&#x7F6E;&#x6253;&#x5305;&#x5230;<code>Docker</code>&#x4E2D;&#xFF0C;&#x4ECE;&#x800C;&#x5B9E;&#x73B0;&#x5FEB;&#x901F;&#x914D;&#x7F6E;&#x3002;</p>
<h3 id="2-1-Dockerfile&#x6587;&#x4EF6;&#x914D;&#x7F6E;"><a href="#2-1-Dockerfile&#x6587;&#x4EF6;&#x914D;&#x7F6E;" class="headerlink" title="2.1 Dockerfile&#x6587;&#x4EF6;&#x914D;&#x7F6E;"></a>2.1 Dockerfile&#x6587;&#x4EF6;&#x914D;&#x7F6E;</h3><p>&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x81EA;&#x5B9A;&#x4E49;&#x7684;<code>docker</code>&#x955C;&#x50CF;&#xFF0C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;<code>Dockerfile</code>&#x63CF;&#x8FF0;&#x6587;&#x4EF6;&#x6765;&#x81EA;&#x52A8;&#x5B8C;&#x6210;&#x3002;<code>Dockerfile</code>&#x6587;&#x4EF6;&#x5305;&#x542B;&#x4E86;&#x521B;&#x5EFA;&#x955C;&#x50CF;&#x6240;&#x9700;&#x8981;&#x7684;<a href="http://seanlook.com/2014/11/17/dockerfile-introduction/" target="_blank" rel="external">&#x5168;&#x90E8;&#x6307;&#x4EE4;</a>&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;<code>Docker build</code>&#x547D;&#x4EE4;&#x6765;&#x521B;&#x5EFA;&#x955C;&#x50CF;&#x3002;</p>
<p>&#x672C;&#x6587;&#x4E2D;&#x4F7F;&#x7528;&#x7684;<code>Dockerfile</code>&#x662F;&#x57FA;&#x4E8E;<code>jenkinsci</code>&#x5F00;&#x6E90;&#x7684;<a href="https://github.com/jenkinsci/docker" target="_blank" rel="external">jenkins</a>&#x955C;&#x50CF;&#xFF0C;&#x5E76;&#x6839;&#x636E;&#x9700;&#x6C42;&#x8FDB;&#x884C;&#x4E86;&#x5B9A;&#x5236;&#xFF0C;&#x90E8;&#x5206;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF1A;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">FROM jenkins:latest  //&#x5DF2;&#x914D;&#x597D;java&#x548C;git&#x73AF;&#x5883;</div><div class="line">...</div><div class="line"># Same as &quot;export TERM=dumb&quot;; prevents error &quot;Could not open terminal for stdout: $TERM not set&quot;</div><div class="line">ENV TERM dumb</div><div class="line"></div><div class="line">#support 32 bit binary on a 64 bit system</div><div class="line">RUN  apt-get update &amp;&amp; apt-get install -y lib32z1 lib32stdc++6 wget &amp;&amp; apt-get clean &amp;&amp; rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*</div><div class="line"></div><div class="line"># &#x4E0B;&#x8F7D;Android Sdk</div><div class="line">...</div><div class="line">RUN cd /opt &amp;&amp; \</div><div class="line">    wget ${ANDROID_SDK_URL} &amp;&amp; \</div><div class="line">    tar -xzf ${ANDROID_SDK_FILENAME} &amp;&amp; \</div><div class="line">    rm ${ANDROID_SDK_FILENAME} &amp;&amp;\</div><div class="line">    echo y | android update sdk --no-ui --all --filter tools,platform-tools,extra-android-m2repository,android-23,build-tools-23.0.0,build-tools-23.0.1,build-tools-23.0.2,build-tools-23.0.3</div><div class="line">...</div><div class="line"></div><div class="line"># &#x62F7;&#x8D1D;JENKINS_HOME&#x6587;&#x4EF6;&#x5939;&#x7684;&#x5185;&#x5BB9;&#x81F3;$JENKINS_HOME&#x76EE;&#x5F55;&#x4E0B;&#xFF0C;&#x8BE5;&#x6587;&#x4EF6;&#x5939;&#x4E0E;Dockerfile&#x5728;&#x540C;&#x4E00;&#x76EE;&#x5F55;&#xFF0C;&#x5305;&#x542B;&#x4E86;jenkins ci&#x7684;&#x5168;&#x90E8;&#x914D;&#x7F6E;&#x4FE1;</div><div class="line">ADD JENKINS_HOME $JENKINS_HOME</div><div class="line"></div><div class="line">EXPOSE 8080</div></pre></td></tr></table></figure>
<p>&#x5728;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x6211;&#x4EEC;&#x4F7F;&#x7528;<code>wget</code>&#x547D;&#x4EE4;&#x53BB;&#x5B98;&#x65B9;&#x4E0B;&#x8F7D;&#x6700;&#x65B0;&#x7684;<code>linux</code>&#x4E0B;<code>android SDK</code>&#x5305;&#xFF0C;&#x5E76;&#x914D;&#x7F6E;&#x73AF;&#x5883;&#xFF0C;&#x7136;&#x540E;&#x4F7F;&#x7528;<code>android</code>&#x547D;&#x4EE4;&#x9009;&#x62E9;&#x548C;&#x81EA;&#x5DF1;&#x9879;&#x76EE;&#x5339;&#x914D;&#x7684;<code>SDK</code>&#x4EE5;&#x53CA;&#x5DE5;&#x5177;&#x7684;&#x7248;&#x672C;&#xFF08;&#x672C;&#x6B21;&#x6253;&#x5305;&#x7684;&#x955C;&#x50CF;&#x4E0B;&#x8F7D;&#x4E86;<code>android-23</code>&#x4EE5;&#x53CA;&#x7CFB;&#x5217;&#x7684;&#x7F16;&#x8BD1;&#x5DE5;&#x5177;&#xFF0C;&#x7528;&#x6237;&#x53EF;&#x6839;&#x636E;&#x9700;&#x6C42;&#x81EA;&#x884C;&#x4FEE;&#x6539;&#xFF09;&#x3002;</p>
<h3 id="2-2-&#x4F7F;&#x7528;Dockerfile&#x6587;&#x4EF6;&#x6784;&#x5EFA;&#x955C;&#x50CF;"><a href="#2-2-&#x4F7F;&#x7528;Dockerfile&#x6587;&#x4EF6;&#x6784;&#x5EFA;&#x955C;&#x50CF;" class="headerlink" title="2.2 &#x4F7F;&#x7528;Dockerfile&#x6587;&#x4EF6;&#x6784;&#x5EFA;&#x955C;&#x50CF;"></a>2.2 &#x4F7F;&#x7528;Dockerfile&#x6587;&#x4EF6;&#x6784;&#x5EFA;&#x955C;&#x50CF;</h3><p>&#x7531;&#x4E8E;<code>Docker</code>&#x662F;&#x57FA;&#x4E8E;<code>Linux</code>&#xFF0C;&#x5728;<code>Mac OS</code>&#x4E0A;&#x8FD0;&#x884C;&#x8D77;&#x6765;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x865A;&#x62DF;&#x7684;<code>Linux</code>&#x73AF;&#x5883;&#xFF0C;&#x5B83;&#x8FD8;&#x9700;&#x8981;&#x82E5;&#x5E72;&#x5DE5;&#x5177;&#x652F;&#x6301;:</p>
<ul>
<li>VirtualBox&#xFF1A;&#x865A;&#x62DF;&#x673A;&#xFF0C;&#x7528;&#x6765;&#x8FD0;&#x884C;<code>Linux</code></li>
<li>docker-machine&#xFF1A;&#x7528;&#x6765;&#x7BA1;&#x7406;&#x865A;&#x62DF;&#x673A;</li>
<li>docker&#xFF1A;<code>Docker</code>&#x672C;&#x8EAB;</li>
<li>docker-compose(Mac OS only)&#xFF1A;&#x7528;&#x6765;&#x7BA1;&#x7406;&#x591A;&#x4E2A;<code>docker</code>&#x5BB9;&#x5668;</li>
<li>Kitematic&#xFF1A;&#x7528;&#x6765;&#x7BA1;&#x7406;&#x8FDC;&#x7A0B;<code>Docker Hub</code></li>
</ul>
<p>&#x4E0A;&#x8FF0;&#x5DE5;&#x5177;&#x5B89;&#x88C5;&#x5B8C;&#x6BD5;&#x540E;&#xFF08;&#x63A8;&#x8350;&#x4F7F;&#x7528;<a href="http://brew.sh/" target="_blank" rel="external">Homebrew</a>&#xFF09;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x521B;&#x5EFA;&#x865A;&#x62DF;&#x673A;&#xFF0C;&#x914D;&#x7F6E;<code>docker</code>&#x73AF;&#x5883;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">docker-machine create --driver virtualbox dev   //1&#x3001;&#x521B;&#x5EFA;&#x865A;&#x62DF;&#x673A;</div><div class="line"></div><div class="line">docker-machine env dev    //2&#x3001;&#x67E5;&#x770B;dev&#x4FE1;&#x606F;</div><div class="line"></div><div class="line"><span class="built_in">eval</span> <span class="string">&quot;<span class="variable">$(docker-machine env dev)</span>&quot;</span>   //3&#x3001;&#x6DFB;&#x52A0;&#x5230;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#xFF0C;&#x5173;&#x8054;&#x5F53;&#x524D;shell</div></pre></td></tr></table></figure>
<p>&#x7136;&#x540E;&#xFF0C;&#x8FDB;&#x5165;&#x5230;<code>Dockerfile</code>&#x6240;&#x5728;&#x7684;&#x76EE;&#x5F55;&#xFF0C;&#x5C31;&#x53EF;&#x4EE5;&#x6267;&#x884C;<code>build</code>&#x547D;&#x4EE4;&#x6253;&#x5305;&#x955C;&#x50CF;&#xFF1A;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">docker build -t [docker-image-name\id] .</div><div class="line">``` </div><div class="line">&#x76EE;&#x524D;&#xFF0C;&#x8BE5;&#x955C;&#x50CF;&#x5DF2;&#x7ECF;&#x4E0A;&#x4F20;&#x5230;[&#x7F51;&#x6613;&#x8702;&#x5DE2;](https://c.163.com/)&#xFF0C;&#x53EF;&#x901A;&#x8FC7;&#x4E00;&#x4E0B;&#x547D;&#x4EE4;&#x83B7;&#x53D6;&#xFF1A;</div><div class="line"></div><div class="line">```bash</div><div class="line">docker pull hub.c.163.com/netease163/ht-jenkinsci:latest</div></pre></td></tr></table></figure>
<p>&#x66F4;&#x591A;&#x5185;&#x5BB9;&#x53EF;&#x53C2;&#x8003;<a href="https://c.163.com/wiki/index.php?title=%E5%88%9B%E5%BB%BA%E8%87%AA%E5%AE%9A%E4%B9%89%E9%95%9C%E5%83%8F" target="_blank" rel="external">&#x7F51;&#x6613;&#x8702;&#x5DE2;&#x4F7F;&#x7528;&#x6307;&#x5357;</a>&#x3002;<br>&#x7EFC;&#x4E0A;&#xFF0C;&#x672C;&#x6B21;<code>Jenkins-ci</code>&#x5BB9;&#x5668;&#x5316;&#x5B9E;&#x8DF5;&#x5C31;&#x8BB2;&#x5B8C;&#x4E86;&#xFF5E;&#x6709;&#x95EE;&#x9898;&#x6216;&#x5EFA;&#x8BAE;&#x53EF;&#x4EE5;&#x8054;&#x7CFB;&#x6211;&#xFF0C;&#x4E00;&#x8D77;&#x4EA4;&#x6D41;&#xFF5E;</p>
<h2 id="&#x53C2;&#x8003;&#x8D44;&#x6599;"><a href="#&#x53C2;&#x8003;&#x8D44;&#x6599;" class="headerlink" title="&#x53C2;&#x8003;&#x8D44;&#x6599;"></a>&#x53C2;&#x8003;&#x8D44;&#x6599;</h2><ul>
<li><a href="https://jenkins.io/" target="_blank" rel="external">jenkins&#x5B98;&#x7F51;</a></li>
<li><a href="https://wiki.jenkins-ci.org/display/JENKINS/Plugins" target="_blank" rel="external">jenkins&#x63D2;&#x4EF6;</a></li>
<li><a href="http://wangkuiwu.github.io/2015/08/07/jenkins-02/" target="_blank" rel="external">Jenkins&#x96C6;&#x6210;android&#x5DE5;&#x7A0B;</a></li>
<li><a href="https://github.com/jenkinsci/jenkins" target="_blank" rel="external">jenkins-ci</a></li>
<li><a href="http://javadoc.jenkins-ci.org/overview-summary.html" target="_blank" rel="external">jenkins&#x7684;Api&#x6587;&#x6863;</a></li>
<li><a href="http://itfish.net/article/53357.html" target="_blank" rel="external">Jenkins&#x6784;&#x5EFA;Android&#x9879;&#x76EE;&#x6301;&#x7EED;&#x96C6;&#x6210;&#x4E4B;findbugs&#x7684;&#x4F7F;&#x7528;
</a></li>
<li><a href="https://github.com/KeepSafe/dexcount-gradle-plugin" target="_blank" rel="external">dexcount-gradle-plugin</a></li>
<li><a href="http://magic.360.cn/index.html" target="_blank" rel="external">FireLine</a></li>
<li><a href="https://github.com/jenkinsci/email-ext-plugin" target="_blank" rel="external">email-ext-plugin</a></li>
<li><a href="https://github.com/jenkinsci/findbugs-plugin" target="_blank" rel="external">findbugs-plugin</a></li>
<li><a href="https://segmentfault.com/a/1190000004881029" target="_blank" rel="external">Android&#x4E2D;&#x4F7F;&#x7528;FindBugs</a></li>
<li><a href="http://www.ruanyifeng.com/blog/2016/01/commit_message_change_log.html" target="_blank" rel="external">Commit message&#x548C;Change log&#x7F16;&#x5199;&#x6307;&#x5357;</a></li>
<li><a href="https://github.com/paulwellnerbou/git-changelog-jenkins-plugin" target="_blank" rel="external">git-changelog-plugin</a></li>
<li><a href="http://qa.blog.163.com/blog/static/19014700220131011102715643/" target="_blank" rel="external">&#x6301;&#x7EED;&#x96C6;&#x6210;&#x4E4B;Jenkins&#x63D2;&#x4EF6;&#x4F7F;&#x7528;-&#x90AE;&#x4EF6;&#x901A;&#x77E5;&#x6A21;&#x677F;&#x5316;</a></li>
<li><a href="http://www.qisanfen.com/?p=474" target="_blank" rel="external">&#x642D;&#x5EFA;linux&#xFF08;ubuntu 14.04&#xFF09;&#x4E0B;&#x7684;android&#x5F00;&#x53D1;&#x73AF;&#x5883;</a></li>
<li><a href="http://qianngchn.github.io/wiki/8.html" target="_blank" rel="external">Ubuntu&#x4E0B;&#x5168;&#x547D;&#x4EE4;&#x884C;&#x642D;&#x5EFA;Android&#x5F00;&#x53D1;&#x73AF;&#x5883;</a></li>
<li><a href="http://www.jianshu.com/p/13c132503d01" target="_blank" rel="external">Run Docker on your Mac</a></li>
<li><a href="http://developerworks.github.io/2014/09/07/android-ci-server/#%E5%AE%89%E8%A3%85Android_SDK" target="_blank" rel="external">&#x642D;&#x5EFA;Android&#x6301;&#x7EED;&#x96C6;&#x6210;&#x670D;&#x52A1;&#x5668;</a></li>
<li><a href="http://blog.saymagic.cn/2016/01/25/docker-image-for-android.html" target="_blank" rel="external">&#x6784;&#x5EFA;&#x7F16;&#x8BD1;Android&#x9879;&#x76EE;&#x7684;Docker&#x955C;&#x50CF;</a></li>
<li><a href="http://www.larrycaiyu.com/2014/11/04/use-docker-for-your-jenkins-demo-1.html" target="_blank" rel="external">&#x4F7F;&#x7528;docker&#x6765;&#x63D0;&#x5347;&#x4F60;&#x7684;Jenkins</a></li>
<li><a href="http://ju.outofmemory.cn/entry/145390" target="_blank" rel="external">Setup Jenkins for Android Integration Using Docker</a></li>
<li><a href="http://blog.csdn.net/sbsujjbcy/article/details/52215051" target="_blank" rel="external">Mac OSX Docker&#x4E0B;&#x642D;&#x5EFA;Android+Jenkins+Gitlab</a></li>
<li><a href="http://www.cnphp6.com/archives/115564" target="_blank" rel="external">gitlab&#x4E0E;jenkins&#x534F;&#x540C;&#x5DE5;&#x4F5C;</a></li>
</ul>

      
    </div>
    <footer>
      
        
        
  
  <div class="tags">
    <a href="/tags/android/">android</a>
  </div>

        
  <div class="addthis addthis_toolbox addthis_default_style">
    
      <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
    
    
      <a class="addthis_button_tweet"></a>
    
    
      <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    
    
      <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal"></a>
    
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">留言</h1>

  
      <div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=123456789012345";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

<div class="fb-comments" data-href="http://hellojql.github.io/2016/12/09/android/Jenkins-ci容器化在Android项目构建中的应用（公众号版）/index.html" data-num-posts="5" data-width="840" data-colorscheme="light"></div>
      
  
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  <SCRIPT language=javascript>
function search(formname) {
    formname.method = "get";
    formname.action = "http://www.baidu.com/baidu";
    document.search_form.word.value = document.search_form.word.value + " site:hellojql.github.io”;
    return true;
}
</SCRIPT>

<div class="search">
    <form name="search_form" target="_blank" onsubmit="search(this)">
        <input type="search" name="word" results="0" placeholder="" onblur="this.value=''">
        <!-- <input type="submit" value="搜索"> -->
    </form>
</div>

  

  
<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <li><a href="/tags/android/">android</a><small>3</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2016 网易前端技术部
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>
