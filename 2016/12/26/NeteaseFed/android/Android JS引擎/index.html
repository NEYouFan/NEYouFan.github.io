<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Androidå¹³å°ä¸Šçš„JavaScriptå¼•æ“ | ç½‘æ˜“å‰ç«¯æŠ€æœ¯éƒ¨</title>
  <meta name="author" content="ç½‘æ˜“å‰ç«¯æŠ€æœ¯éƒ¨">
  
  <meta name="description" content="ç½‘æ˜“æ­ç ”å‰ç«¯æŠ€æœ¯éƒ¨ï¼Œåˆ†äº«æœ€å‰æ²¿çš„æŠ€æœ¯ã€‚">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Androidå¹³å°ä¸Šçš„JavaScriptå¼•æ“"/>
  <meta property="og:site_name" content="ç½‘æ˜“å‰ç«¯æŠ€æœ¯éƒ¨"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="ç½‘æ˜“å‰ç«¯æŠ€æœ¯éƒ¨" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">ç½‘æ˜“å‰ç«¯æŠ€æœ¯éƒ¨</a></h1>
  <h2><a href="/"></a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2016-12-26T04:34:04.000Z"><a href="/2016/12/26/NeteaseFed/android/Android JSå¼•æ“/">2016-12-26</a></time>
      
      
  
    <h1 class="title">Androidå¹³å°ä¸Šçš„JavaScriptå¼•æ“</h1>
  

    </header>
    <div class="entry">
      
        <h3 id="ä¸€ã€å‰è¨€"><a href="#ä¸€ã€å‰è¨€" class="headerlink" title="ä¸€ã€å‰è¨€"></a>ä¸€ã€å‰è¨€</h3><p>è¿‘æœŸåœ¨äº§å“ä¸­é‡åˆ°äº†è¿™æ ·çš„ä¸€ä¸ªé—®é¢˜ï¼šWebç«¯å·²ç»å­˜åœ¨ä¸€ä¸ªåŠŸèƒ½å®Œå–„çš„JavaScriptåº“ï¼Œå¦‚æœå°†ç›¸å…³WebåµŒå…¥åˆ°Appä¸­ï¼Œåˆ™WebViewå°†å¸¦æ¥ä¸€å®šçš„æ€§èƒ½å½±å“ï¼›å¦‚æœAndroidç«¯æœ¬åœ°å¼€å‘ä¸€ä¸ªç›¸åŒçš„åº“ï¼Œåˆ™éœ€è¦æ¶ˆè€—å¤§é‡çš„èµ„æºã€‚è€ƒè™‘åˆ°ä»£ç å¤ç”¨å’Œè·¨å¹³å°å¼€å‘ï¼Œå›¢é˜Ÿè°ƒç ”äº†JSå¼•æ“åœ¨Androidä¸Šçš„ä½¿ç”¨ï¼Œå¸Œæœ›è§£å†³â€ä¸ç»è¿‡WebViewï¼Œè€Œå°†JSåº“æ‹¿åˆ°Androidç«¯è¿è¡Œï¼Œå¹¶å°†è¿è¡Œç»“æœäº¤ç»™æœ¬åœ°è¾“å‡ºâ€è¿™ä¸€éœ€æ±‚ã€‚<a id="more"></a></p>
<p>JSå¼•æ“èƒ½å¤Ÿè§£æJSè„šæœ¬ï¼Œé€šå¸¸è¢«ä¾é™„äºæµè§ˆå™¨ä¸­ï¼Œä¾‹å¦‚Safariæ‰€ä½¿ç”¨çš„<strong>JavaScriptCore</strong>ã€Google Chromeæ‰€ä½¿ç”¨çš„<strong>V8</strong>å’ŒFireFoxæ‰€ä½¿ç”¨çš„<strong>SpiderMonkey</strong>ç­‰ç­‰ã€‚ä¹Ÿè¢«ç”¨ä½œç§»åŠ¨ç«¯çš„è·¨å¹³å°å¼€å‘ï¼Œä¾‹å¦‚NativeScript(<a href="http://developer.telerik.com/featured/nativescript-works/)åœ¨iOSç«¯å’ŒAndroidåˆ†åˆ«ä½¿ç”¨äº†JavaScriptCoreå’ŒV8ï¼ŒReactNative(https://facebook.github.io/react-native/docs/javascript-environment.html)åˆ™éƒ½ä½¿ç”¨äº†JavaScriptCoreã€‚" target="_blank" rel="external">http://developer.telerik.com/featured/nativescript-works/)åœ¨iOSç«¯å’ŒAndroidåˆ†åˆ«ä½¿ç”¨äº†JavaScriptCoreå’ŒV8ï¼ŒReactNative(https://facebook.github.io/react-native/docs/javascript-environment.html)åˆ™éƒ½ä½¿ç”¨äº†JavaScriptCoreã€‚</a></p>
<h3 id="äºŒã€JSå¼•æ“ä»‹ç»"><a href="#äºŒã€JSå¼•æ“ä»‹ç»" class="headerlink" title="äºŒã€JSå¼•æ“ä»‹ç»"></a>äºŒã€JSå¼•æ“ä»‹ç»</h3><p>åœ¨Androidç³»ç»Ÿä¸­èƒ½è¿è¡Œçš„JSå¼•æ“æœ‰å¦‚ä¸‹5ç§ï¼š</p>
<h4 id="1-JavaScriptCore-https-trac-webkit-org-wiki-JavaScriptCore"><a href="#1-JavaScriptCore-https-trac-webkit-org-wiki-JavaScriptCore" class="headerlink" title="1. JavaScriptCore(https://trac.webkit.org/wiki/JavaScriptCore)"></a>1. JavaScriptCore(<a href="https://trac.webkit.org/wiki/JavaScriptCore" target="_blank" rel="external">https://trac.webkit.org/wiki/JavaScriptCore</a>)</h4><p>JavaScriptCoreæ˜¯ä¸€ä¸ªåœ¨WebKitä¸­æä¾›JSå¼•æ“çš„å¼€æºæ¡†æ¶ï¼Œæœ€è¿‘æ›´æ–°æ—¥æœŸæ˜¯2016å¹´9æœˆ26æ—¥ã€‚ç›®å‰è¯¥å¼•æ“ç”±Appleç»´æŠ¤ï¼Œä½¿ç”¨äºSafariæµè§ˆå™¨ï¼ŒiOS7åä¹Ÿé›†æˆåˆ°äº†iPhoneå¹³å°ã€‚</p>
<p>ç”±äºå…¶ä½¿ç”¨Cè¯­è¨€ç¼–å†™ï¼Œå› æ­¤åœ¨Androidå¼€å‘ä¸­å¹¶ä¸èƒ½ç›´æ¥ä½¿ç”¨ã€‚Githubä¸Šçš„å¼€æºé¡¹ç›®<strong>AndroidJSCore</strong>(<a href="https://github.com/ericwlange/AndroidJSCore)èƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…ç»è¿‡è°ƒç”¨Javaæ¥å£è€Œä½¿ç”¨JavaScriptCoreã€‚è¯¥é¡¹ç›®ç”±**ericwlange**ç»´æŠ¤ï¼Œæœ€æ–°ç‰ˆæœ¬3.0.1å‘å¸ƒäº2016å¹´7æœˆ31æ—¥ï¼Œæœ‰APIæ–‡æ¡£å’Œç¤ºä¾‹ä»£ç ï¼Œä½†ç¼ºå°‘ç›¸å…³æŠ€æœ¯æ–‡ç« ï¼Œå¹¶ä»å­˜åœ¨ä¸€äº›æ€§èƒ½é—®é¢˜ã€‚" target="_blank" rel="external">https://github.com/ericwlange/AndroidJSCore)èƒ½å¤Ÿå¸®åŠ©å¼€å‘è€…ç»è¿‡è°ƒç”¨Javaæ¥å£è€Œä½¿ç”¨JavaScriptCoreã€‚è¯¥é¡¹ç›®ç”±**ericwlange**ç»´æŠ¤ï¼Œæœ€æ–°ç‰ˆæœ¬3.0.1å‘å¸ƒäº2016å¹´7æœˆ31æ—¥ï¼Œæœ‰APIæ–‡æ¡£å’Œç¤ºä¾‹ä»£ç ï¼Œä½†ç¼ºå°‘ç›¸å…³æŠ€æœ¯æ–‡ç« ï¼Œå¹¶ä»å­˜åœ¨ä¸€äº›æ€§èƒ½é—®é¢˜ã€‚</a></p>
<h4 id="2-V8-https-developers-google-com-v8"><a href="#2-V8-https-developers-google-com-v8" class="headerlink" title="2. V8(https://developers.google.com/v8/)"></a>2. V8(<a href="https://developers.google.com/v8/" target="_blank" rel="external">https://developers.google.com/v8/</a>)</h4><p>V8æ˜¯ç”±Googleå¼€å‘å¹¶ç»´æŠ¤çš„é«˜æ€§èƒ½å¼€æºJSå¼•æ“ï¼Œé‡‡ç”¨C++ç¼–å†™ï¼Œä½¿ç”¨äºGoogle Chromeæµè§ˆå™¨ã€‚æœ€æ–°ç‰ˆæœ¬ä¸ºV8 5.5 betaï¼Œæ›´æ–°äº2016å¹´10æœˆ24æ—¥ã€‚</p>
<p>åŒJavaScriptCoreä¸€æ ·ï¼Œåœ¨Androidå¼€å‘ä¸­ï¼Œç›¸å…³æ¥å£éœ€è¦é€šè¿‡ä¸€å±‚åŒ…è£…è¿›è¡Œè°ƒç”¨ã€‚Githubä¸Šçš„å¼€æºé¡¹ç›®<strong>J2V8</strong>(<a href="https://github.com/eclipsesource/J2V8)ï¼Œç›¸å…³æ–‡ç« å¯åœ¨æ­¤å¤„(http://eclipsesource.com/blogs/tag/j2v8/)æŸ¥é˜…ï¼Œæœ€æ–°ç‰ˆæœ¬4.6.0å‘å¸ƒäº2016å¹´9æœˆ22æ—¥ã€‚" target="_blank" rel="external">https://github.com/eclipsesource/J2V8)ï¼Œç›¸å…³æ–‡ç« å¯åœ¨æ­¤å¤„(http://eclipsesource.com/blogs/tag/j2v8/)æŸ¥é˜…ï¼Œæœ€æ–°ç‰ˆæœ¬4.6.0å‘å¸ƒäº2016å¹´9æœˆ22æ—¥ã€‚</a></p>
<p>J2V8æ˜¯ä¸€å¥—é’ˆå¯¹V8çš„Javaç»‘å®šã€‚J2V8çš„å¼€å‘ä¸ºAndroidå¹³å°å¸¦æ¥äº†é«˜æ•ˆçš„Javascriptçš„æ‰§è¡Œç¯å¢ƒï¼Œå…¶ä»¥æ€§èƒ½ä¸å†…å­˜æ¶ˆè€—ä¸ºè®¾è®¡ç›®æ ‡ã€‚å®ƒé‡‡ç”¨äº†â€œåŸºæœ¬ç±»å‹ä¼˜å…ˆâ€åŸåˆ™ï¼Œæ„å‘³ç€ä¸€ä¸ªæ‰§è¡Œç»“æœæ˜¯åŸºæœ¬ç±»å‹ï¼Œé‚£ä¹ˆæ‰€è¿”å›çš„å€¼ä¹Ÿå°±æ˜¯è¯¥åŸºæœ¬ç±»å‹ã€‚å®ƒè¿˜é‡‡ç”¨äº†â€œæ‡’åŠ è½½â€æŠ€æœ¯ï¼Œåªæœ‰å½“JSæ‰§è¡Œç»“æœè¢«è®¿é—®æ—¶ï¼Œæ‰ä¼šé€šè¿‡JNIå¤åˆ¶åˆ°Javaä¸­ã€‚</p>
<p>æ­¤å¤–J2V8æä¾›äº†<code>release()</code>æ–¹æ³•ï¼Œå¼€å‘è€…åœ¨æŸä¸€å¯¹è±¡ä¸å†éœ€è¦æ—¶ä¸»åŠ¨è°ƒç”¨è¯¥æ–¹æ³•å»é‡Šæ”¾æœ¬åœ°å¯¹è±¡å¥æŸ„ï¼Œé‡Šæ”¾è§„åˆ™å¦‚ä¸‹ï¼š</p>
<ul>
<li>å¦‚æœæ˜¯ç”±ä»£ç åˆ›å»ºçš„å¯¹è±¡ï¼Œé‚£ä¹ˆå¿…é¡»é‡Šæ”¾å®ƒï¼›å¦‚æœä¸€ä¸ªå¯¹è±¡æ˜¯é€šè¿‡è¿”å›è¯­å¥ä¼ å›æ¥çš„è¯ï¼Œç³»ç»Ÿä¼šæ›¿ä½ é‡Šæ”¾å®ƒï¼›</li>
<li>å¦‚æœæ˜¯ç”±ç³»ç»Ÿåˆ›å»ºçš„å¯¹è±¡ï¼Œåˆ™æ— éœ€æ‹…å¿ƒé‡Šæ”¾ï¼Œè€Œå¦‚æœå¯¹è±¡æ˜¯JSæ–¹æ³•çš„è¿”å›å€¼ï¼Œå°±å¿…é¡»æ‰‹åŠ¨çš„é‡Šæ”¾å®ƒã€‚</li>
</ul>
<h4 id="3-SpiderMonkey-https-developer-mozilla-org-en-US-docs-Mozilla-Projects-SpiderMonkey"><a href="#3-SpiderMonkey-https-developer-mozilla-org-en-US-docs-Mozilla-Projects-SpiderMonkey" class="headerlink" title="3. SpiderMonkey(https://developer.mozilla.org/en-US/docs/Mozilla/Projects/SpiderMonkey)"></a>3. SpiderMonkey(<a href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/SpiderMonkey" target="_blank" rel="external">https://developer.mozilla.org/en-US/docs/Mozilla/Projects/SpiderMonkey</a>)</h4><p>å¼€æºJSå¼•æ“SpiderMonkeyæœ€åˆç”±Netscapeå¼€å‘ï¼Œå¦‚ä»Šç”±Mozillaå¼€å‘å¹¶ç»´æŠ¤ï¼Œä¸”è¢«å¹¿æ³›ç”¨äºMozillaäº§å“ï¼ˆå¦‚FireFoxï¼‰ã€‚æœ€æ–°ç‰ˆæœ¬ä¸ºSpiderMonkey 45ï¼Œæ›´æ–°äº2016å¹´4æœˆ14æ—¥ã€‚</p>
<p>SpiderMonkeyæä¾›äº†ä¸€äº›æ ¸å¿ƒçš„JavaScriptæ•°æ®ç±»å‹ï¼Œå¦‚æ•°å­—ï¼Œå­—ç¬¦ä¸²ï¼Œæ•°ç»„ï¼Œå¯¹è±¡ç­‰ç­‰ï¼Œä»¥åŠä¸€äº›æ–¹æ³•å¦‚Array.pushã€‚å®ƒè¿˜ä½¿å¾—æ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½å®¹æ˜“å°†å…¶è‡ªå·±çš„å¯¹è±¡å’Œæ–¹æ³•æš´éœ²ç»™JavaScriptä»£ç ã€‚åº”ç”¨å¼€å‘è€…å¯ä»¥å†³å®šåº”ç”¨å¦‚ä½•å°†ä¸æ‰€å†™è„šæœ¬ç›¸å…³çš„å¯¹è±¡æš´éœ²å‡ºæ¥ã€‚</p>
<h4 id="4-Rhino-https-developer-mozilla-org-en-US-docs-Mozilla-Projects-Rhino"><a href="#4-Rhino-https-developer-mozilla-org-en-US-docs-Mozilla-Projects-Rhino" class="headerlink" title="4. Rhino(https://developer.mozilla.org/en-US/docs/Mozilla/Projects/Rhino)"></a>4. Rhino(<a href="https://developer.mozilla.org/en-US/docs/Mozilla/Projects/Rhino" target="_blank" rel="external">https://developer.mozilla.org/en-US/docs/Mozilla/Projects/Rhino</a>)</h4><p>Rhinoæ˜¯ç”±Mozillaå¼€å‘çš„å¼€æºJSå¼•æ“ã€‚é‡‡ç”¨Javaç¼–å†™ï¼Œå› æ­¤å¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œåœ¨JDK 6ã€JDK 7ä¸­æ›´æ˜¯æ†ç»‘äº†è¯¥å¼•æ“ã€‚æœ€æ–°ç‰ˆæœ¬ä¸ºRhino 1.7.7.1ï¼Œæ›´æ–°äº2016å¹´2æœˆ1æ—¥ã€‚</p>
<p>å…¶æä¾›çš„ç‰¹æ€§åŒ…æ‹¬ï¼š</p>
<ul>
<li>JavaScript 1.7çš„å…¨éƒ¨ç‰¹æ€§</li>
<li>å¯ä»¥ç”¨è„šæœ¬æ–¹å¼è°ƒç”¨Java</li>
<li>ç”¨ä¸€ä¸ªJavaScript Shellæ¥æ‰§è¡ŒJavaScriptè„šæœ¬</li>
<li>ç”¨ä¸€ä¸ªJavaScriptç¼–è¯‘å™¨æ¥å°†JavaScriptè„šæœ¬æ–‡ä»¶è½¬æ¢æˆJavaç±»æ–‡ä»¶</li>
<li>ç”¨ä¸€ä¸ªJavaScriptè°ƒè¯•å™¨æ¥è°ƒè¯•Rhinoæ‰§è¡Œçš„è„šæœ¬</li>
</ul>
<h4 id="5-Nashorn-http-openjdk-java-net-projects-nashorn"><a href="#5-Nashorn-http-openjdk-java-net-projects-nashorn" class="headerlink" title="5. Nashorn(http://openjdk.java.net/projects/nashorn/)"></a>5. Nashorn(<a href="http://openjdk.java.net/projects/nashorn/" target="_blank" rel="external">http://openjdk.java.net/projects/nashorn/</a>)</h4><p>Nashornç”±Oracleå¼€å‘å¹¶ç»´æŠ¤ï¼Œä»JDK 8å¼€å§‹ï¼ŒRhinoè¢«Nashornä»£æ›¿ï¼Œæˆä¸ºJDKé»˜è®¤JSå¼•æ“ã€‚NashornåŒJDK 8ä¸€åŒå‘å¸ƒå’Œå¼€æºï¼Œè¾ƒRhinoè€Œè¨€æ€§èƒ½æ›´å¥½ï¼Œä½†ä¸æ”¯æŒAndroid Dalvikè™šæ‹Ÿæœºã€‚</p>
<h3 id="ä¸‰ã€JSå¼•æ“æ€§èƒ½æ¯”è¾ƒ"><a href="#ä¸‰ã€JSå¼•æ“æ€§èƒ½æ¯”è¾ƒ" class="headerlink" title="ä¸‰ã€JSå¼•æ“æ€§èƒ½æ¯”è¾ƒ"></a>ä¸‰ã€JSå¼•æ“æ€§èƒ½æ¯”è¾ƒ</h3><p>ä»å¯ç”¨æ€§æ–¹é¢è€ƒè™‘ï¼Œé€‰å–äº†JavaScriptCore+AndroidJSCoreï¼ˆä¸‹æ–‡ç”±â€œJSCoreâ€æŒ‡ä»£ï¼‰ã€V8+J2V8ï¼ˆä¸‹æ–‡ç”±â€œJ2V8â€æŒ‡ä»£ï¼‰å’ŒRhinoä¸‰ç§æ–¹æ¡ˆè¿›è¡Œå®éªŒã€‚</p>
<h4 id="åˆ›å»ºJSç¯å¢ƒ"><a href="#åˆ›å»ºJSç¯å¢ƒ" class="headerlink" title="åˆ›å»ºJSç¯å¢ƒ"></a>åˆ›å»ºJSç¯å¢ƒ</h4><p>éƒ¨åˆ†å¼•æ“å¹¶ä¸æ”¯æŒç›´æ¥è¿è¡Œæ–‡ä»¶ï¼Œå› æ­¤å°†JSä»£ç ä½œä¸ºå­—ç¬¦ä¸²äº¤ç»™JSå¼•æ“æ‰§è¡Œï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­å¯ä»¥è°ƒç”¨å·²æ³¨å†Œåˆ°JSä¸Šä¸‹æ–‡çš„Javaæ–¹æ³•ã€‚</p>
<h5 id="JSCore"><a href="#JSCore" class="headerlink" title="JSCore"></a>JSCore</h5><pre><code>//åˆ›å»ºJSä¸Šä¸‹æ–‡
JSContext context = new JSContext();
//åˆ›å»ºJavaæ–¹æ³•
JSFunction func = new JSFunction(context, &quot;func&quot;) {
    public void func(String msg) {
        //ç›¸å…³å¤„ç†
    }
};
//å°†Javaæ–¹æ³•æ³¨å†Œåˆ°JSä¸Šä¸‹æ–‡
context.property(&quot;func&quot;, func);
//æ‰§è¡ŒJS
context.evaluateScript(/*JSä»£ç */);
</code></pre><h5 id="J2V8"><a href="#J2V8" class="headerlink" title="J2V8"></a>J2V8</h5><pre><code>//åˆ›å»ºJSä¸Šä¸‹æ–‡
V8 context = V8.createV8Runtime();
//åˆ›å»ºJavaæ–¹æ³•ï¼Œå¹¶æ³¨å†Œåˆ°JSä¸Šä¸‹æ–‡
context.registerJavaMethod(new JavaVoidCallback() {
    public void invoke(final V8Object receiver, final V8Array parameters) {
        //ç›¸å…³å¤„ç†
    }
}, &quot;func&quot;);
//æ‰§è¡ŒJS
context.executeScript(js);
//é‡Šæ”¾èµ„æº
context.release();
</code></pre><h5 id="Rhino"><a href="#Rhino" class="headerlink" title="Rhino"></a>Rhino</h5><pre><code>class Func {
    void func(String msg) {
        //ç›¸å…³å¤„ç†
    }
}

//åˆ›å»ºJSä¸Šä¸‹æ–‡
Context context = Context.enter();
context.setOptimizationLevel(-1);
Scriptable scope = context.initStandardObjects();
try {
    //æ‰§è¡ŒJS
    context.evaluateString(scope, js, &quot;RhinoUtil&quot;, 1, null);

    //å°†Javaæ–¹æ³•å°è£…åˆ°ç±»ä¸­ï¼Œå¹¶ä½œä¸ºå‚æ•°ä¼ é€’ç»™JSæ–¹æ³•
    Function function = (Function) scope.get(&quot;rhinofunc&quot;, scope);
    function.call(context, scope, scope, new Object[]{new Func()});
} finally {
    Context.exit();
}
</code></pre><h4 id="å®éªŒã€‡ï¼šåŒ…çš„ä¾èµ–"><a href="#å®éªŒã€‡ï¼šåŒ…çš„ä¾èµ–" class="headerlink" title="å®éªŒã€‡ï¼šåŒ…çš„ä¾èµ–"></a>å®éªŒã€‡ï¼šåŒ…çš„ä¾èµ–</h4><p>æ¯”è¾ƒå„æ–¹æ¡ˆä¾èµ–åŒ…å¼•å…¥åï¼Œapkçš„ä½“ç§¯å¢é‡ï¼š</p>
<table>
<thead>
<tr>
<th></th>
<th>ä¾èµ–åŒ…å ç”¨(MB)</th>
<th>ä¾èµ–æ–¹å¼</th>
</tr>
</thead>
<tbody>
<tr>
<td>J2V8</td>
<td>8.2</td>
<td>compile â€˜com.eclipsesource.j2v8:j2v8:4.6.0@aarâ€™</td>
</tr>
<tr>
<td>JSCore</td>
<td>44.9ğŸ˜³</td>
<td>compile â€˜com.github.ericwlange:AndroidJSCore:3.0.1â€™</td>
</tr>
<tr>
<td>Rhino</td>
<td>0.6</td>
<td>å°†jaråŒ…æ”¾å…¥libsæ–‡ä»¶å¤¹ä¸‹</td>
</tr>
</tbody>
</table>
<ul>
<li>J2V8å¼•å…¥çš„æ˜¯å…¨å¹³å°åŒ…ï¼Œå®é™…ä¸Šå®ƒæœ‰é’ˆå¯¹Linuxã€Windowsã€MacOSã€Androidå„å¹³å°è¿›è¡Œæ‰“åŒ…ï¼Œè€ŒAndroidå¹³å°æœ€æ–°ç‰ˆæœ¬ä¸º3.0.5ï¼ˆçº¦4MBï¼‰ï¼Œå¹¶ä¸æ˜¯æœ€æ–°çš„4.6.0ç‰ˆæœ¬</li>
<li>å…·AndroidJsCoreä½œè€…å›ç­”ï¼Œç”±äºå¿…é¡»é’ˆå¯¹å„CPUæ¶æ„è¿›è¡Œæ‰“åŒ…ï¼Œè€Œæœ‰7ç§CPUæ¶æ„ï¼Œæ¯ç§æ¶æ„åŒ…çº¦6MBï¼Œå› æ­¤æ•´ä¸ªä¾èµ–åŒ…ä½“ç§¯ç›¸æ¯”ä¹‹ä¸‹æ˜¾å¾—åºå¤§ï¼Œä½†ä¹Ÿå¯ä»¥é€šè¿‡ABIs Splitsè¿›è¡Œæ‹†åˆ†ã€‚</li>
<li>Rhinoçš„jaråŒ…ä»…1.2Mï¼Œå› æ­¤apkå¢é‡å¹¶ä¸æ˜¾è‘—ã€‚</li>
</ul>
<h4 id="å®éªŒä¸€ï¼šç©ºå¾ªç¯"><a href="#å®éªŒä¸€ï¼šç©ºå¾ªç¯" class="headerlink" title="å®éªŒä¸€ï¼šç©ºå¾ªç¯"></a>å®éªŒä¸€ï¼šç©ºå¾ªç¯</h4><p>JSCoreå’ŒJ2V8æ‰§è¡ŒJSä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code>var i = 0;
for (;i &lt; /*æ¬¡æ•°*/; i++) {
}
</code></pre><p>Rhinoæ‰§è¡ŒJSä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code>function rhinofunc(f) {
    var i = 0;
    for (;i &lt; /*æ¬¡æ•°*/; i++) {
    }
}
</code></pre><p>å¾ªç¯æ¬¡æ•°åˆ†åˆ«è®¾ç½®ä¸º100ä¸‡ã€1000ä¸‡ã€1äº¿æ¬¡ï¼Œåœ¨Javaä»£ç ä¸­æ‰§è¡ŒJSå‰è¾“å‡ºå¼€å§‹æ—¶é—´ï¼Œåœ¨JSæ‰§è¡Œåè¾“å‡ºç»“æŸæ—¶é—´ï¼Œç›¸å‡å¾—å‡ºæ‰§è¡Œæ—¶é—´è®°å½•å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>æ‰§è¡Œæ—¶é—´(ms)</th>
<th>100ä¸‡æ¬¡</th>
<th>1000ä¸‡æ¬¡</th>
<th>1äº¿æ¬¡</th>
</tr>
</thead>
<tbody>
<tr>
<td>J2V8</td>
<td>17.6</td>
<td>122.8</td>
<td>1116.6</td>
</tr>
<tr>
<td>JSCore</td>
<td>22</td>
<td>173.2</td>
<td>1551</td>
</tr>
<tr>
<td>Rhino</td>
<td>2078.4</td>
<td>22358.4</td>
<td>198600ğŸ˜³</td>
</tr>
</tbody>
</table>
<p>ç”±å®éªŒç»“æœå¯ä»¥çœ‹åˆ°ï¼šJ2V8å’ŒJSCoreç›¸æ¯”ï¼ŒJ2V8æ‰§è¡Œæ—¶é—´æ›´çŸ­ï¼Œä½†ä¸¤è€…æ—¶é—´éƒ½åœ¨åŒä¸€æ•°é‡çº§ä¸Šã€‚è€ŒRhinoæ‰§è¡Œæ—¶é—´è¿œå¤§äºå‰ä¸¤è€…ï¼Œæ ¹æœ¬åŸå› åœ¨äºJavaç¨‹åºè¿è¡Œè¾ƒC/C++æ…¢ã€‚</p>
<h4 id="å®éªŒäºŒï¼šJSè°ƒç”¨Javaæ–¹æ³•"><a href="#å®éªŒäºŒï¼šJSè°ƒç”¨Javaæ–¹æ³•" class="headerlink" title="å®éªŒäºŒï¼šJSè°ƒç”¨Javaæ–¹æ³•"></a>å®éªŒäºŒï¼šJSè°ƒç”¨Javaæ–¹æ³•</h4><p>JSCoreå’ŒJ2V8æ‰§è¡ŒJSä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code>var i = 0;
for (;i &lt; /*æ¬¡æ•°*/; i++) {
    func();
}
</code></pre><p>Rhinoæ‰§è¡ŒJSä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code>function rhinofunc(f) {
    var i = 0;
    for (;i &lt; /*æ¬¡æ•°*/; i++) {
        f.func();
    }
}
</code></pre><p>è°ƒç”¨æ¬¡æ•°åˆ†åˆ«è®¾ç½®ä¸º1ä¸‡ã€10ä¸‡ã€100ä¸‡æ¬¡ï¼Œè®°å½•æ‰§è¡Œæ—¶é—´å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>æ‰§è¡Œæ—¶é—´(ms)</th>
<th>1ä¸‡æ¬¡</th>
<th>10ä¸‡æ¬¡</th>
<th>100ä¸‡æ¬¡</th>
</tr>
</thead>
<tbody>
<tr>
<td>J2V8</td>
<td>490.2</td>
<td>4855.8</td>
<td>47527</td>
</tr>
<tr>
<td>JSCore</td>
<td>1287.6</td>
<td>13448.2</td>
<td>121586.8ğŸ˜³</td>
</tr>
<tr>
<td>Rhino</td>
<td>408.2</td>
<td>4007.2</td>
<td>36752.4</td>
</tr>
</tbody>
</table>
<p>å¯åŠ¨Appæ—¶è®°å½•å ç”¨å†…å­˜ï¼ŒJSæ‰§è¡Œè¿‡ç¨‹ä¸­è®°å½•æœ€é«˜å ç”¨å†…å­˜ï¼Œç›¸å‡å¾—å‡ºå ç”¨å†…å­˜ã€‚</p>
<table>
<thead>
<tr>
<th>å ç”¨å†…å­˜(KB)</th>
<th>1ä¸‡æ¬¡</th>
<th>10ä¸‡æ¬¡</th>
<th>100ä¸‡æ¬¡</th>
</tr>
</thead>
<tbody>
<tr>
<td>J2V8</td>
<td>7264</td>
<td>14004</td>
<td>17328</td>
</tr>
<tr>
<td>JSCore</td>
<td>15368</td>
<td>15140</td>
<td>16720</td>
</tr>
<tr>
<td>Rhino</td>
<td>2776</td>
<td>9084</td>
<td>9116</td>
</tr>
</tbody>
</table>
<p>åŒæ ·ä¹Ÿæ˜¯ç”±äºå¼€å‘è¯­è¨€çš„å·®å¼‚ï¼Œåœ¨JSè°ƒç”¨Javaä¸ŠRhinoæ€§èƒ½æ›´ä¼˜ã€‚æ‰§è¡Œæ—¶é—´æ–¹é¢ï¼ŒJ2V8æ¥è¿‘Rhinoï¼Œè€ŒJSCoreåˆ™è¿œè½åäºå‰ä¸¤ç§æ–¹æ¡ˆï¼Œè¿™å¯èƒ½ä¸å…¶Javaç»‘å®šå±‚æœ‰å¾ˆå¤§å…³ç³»ã€‚å¯¹äºJ2V8å’ŒJSCoreåˆ™éœ€è¦å…ˆç»è¿‡JNIåŒ…è£…å±‚æ‰èƒ½è°ƒç”¨åˆ°Javaæ–¹æ³•ï¼Œè€Œå¤§é‡çš„JNIè°ƒç”¨æ˜¯éå¸¸è€—æ—¶ã€è€—å†…å­˜çš„ã€‚</p>
<h4 id="å®éªŒä¸‰ï¼šJSé€’å½’è®¡ç®—æ–æ³¢é‚£å¥‘"><a href="#å®éªŒä¸‰ï¼šJSé€’å½’è®¡ç®—æ–æ³¢é‚£å¥‘" class="headerlink" title="å®éªŒä¸‰ï¼šJSé€’å½’è®¡ç®—æ–æ³¢é‚£å¥‘"></a>å®éªŒä¸‰ï¼šJSé€’å½’è®¡ç®—æ–æ³¢é‚£å¥‘</h4><p>JSä»£ç æ–æ³¢é‚£å¥‘å‡½æ•°å¦‚ä¸‹ï¼š</p>
<pre><code>function fibo(n) {
    if (n == 1 || n == 2) {
        return 1;
    }
    else {
        return fibo(n - 1) + fibo(n - 2);
    }
}
</code></pre><table>
<thead>
<tr>
<th>æ‰§è¡Œæ—¶é—´(ms)</th>
<th>fibo(20)</th>
<th>fibo(30)</th>
<th>fibo(40)</th>
</tr>
</thead>
<tbody>
<tr>
<td>J2V8</td>
<td>4</td>
<td>67.6</td>
<td>8158.6</td>
</tr>
<tr>
<td>JSCore</td>
<td>6.6</td>
<td>76.2</td>
<td>7884.4</td>
</tr>
<tr>
<td>Rhino</td>
<td>248.4</td>
<td>26898</td>
<td>???ğŸ˜³</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>å ç”¨å†…å­˜(KB)</th>
<th>fibo(20)</th>
<th>fibo(30)</th>
<th>fibo(40)</th>
</tr>
</thead>
<tbody>
<tr>
<td>J2V8</td>
<td>6148</td>
<td>6120</td>
<td>17328</td>
</tr>
<tr>
<td>JSCore</td>
<td>6204</td>
<td>6200</td>
<td>16720</td>
</tr>
<tr>
<td>Rhino</td>
<td>5284</td>
<td>9052</td>
<td>9116</td>
</tr>
</tbody>
</table>
<p>Rhinoè¿è¡ŒJSæ—¶é¢‘ç¹GCï¼Œè™½ç„¶ä½¿å…¶æ‰€å å†…å­˜è¾ƒå°‘ï¼Œä½†æ‰§è¡Œé€Ÿåº¦éå¸¸ç¼“æ…¢ï¼Œç›¸æ¯”ä¹‹ä¸‹J2V8å’ŒJSCoreæ–¹æ¡ˆæ•ˆç‡æ›´é«˜ã€‚</p>
<h4 id="å®éªŒæ€»ç»“"><a href="#å®éªŒæ€»ç»“" class="headerlink" title="å®éªŒæ€»ç»“"></a>å®éªŒæ€»ç»“</h4><p>å•ä»JSå¼•æ“æ¥è¯´ï¼šRhinoæ‰§è¡Œä¸éœ€è¦é€šè¿‡JNIä¸”å ç”¨æ›´å°‘çš„å†…å­˜ï¼Œä½†æ‰§è¡Œæ•ˆç‡å¾ˆä½ï¼›V8å’ŒJavaScriptCoreç­‰Cè¯­è¨€å¼€å‘çš„å¼•æ“è¿œèƒœäºRhinoç­‰Javaå¼€å‘çš„å¼•æ“ï¼Œä½†éœ€è¦ä¸€å±‚JavaåŒ…è£…å±‚ï¼Œå¹¶å­˜åœ¨JNIè°ƒç”¨æ€§èƒ½é—®é¢˜ã€‚å°±J2V8å’ŒAndroidJSCoreä¸¤ä¸ªåŒ…è£…å±‚è€Œè¨€ï¼šJ2V8çš„å¯ç”¨æ€§ã€å¯é æ€§ã€å¥å£®æ€§æ›´ä¼˜ï¼›AndroidJSCoreè¿˜å­˜åœ¨ç€ä¸å°‘çš„æ€§èƒ½é—®é¢˜ï¼Œåœ¨ä¸Šè¿°å®éªŒä¸­å‡ºç°è¾ƒå°‘ï¼Œä½†å®é™…å¼€å‘ä¸­è¿˜å­˜åœ¨å¾ˆå¤šå‘ã€‚</p>
<p>ä»¥ä¸Šä¸‰ç§å®ç°æ–¹æ¡ˆä¸­æ›´æ¨èJ2V8æ–¹æ¡ˆã€‚å¯¹äºå†…å­˜é—®é¢˜ï¼ŒJ2V8çš„å†…å­˜é‡Šæ”¾æœºåˆ¶è¾ƒä¸ºå®Œå–„ï¼Œåœ¨å®é™…å¼€å‘ä¸­å¯ä»¥é€šè¿‡ä¸»åŠ¨releaseæ¥é‡Šæ”¾å†…å­˜ï¼›å¯¹äºJNIè°ƒç”¨æ€§èƒ½é—®é¢˜ï¼ŒJ2V8å›¢é˜Ÿä¹Ÿåœ¨å°è¯•é€šè¿‡æ‰¹å¤„ç†å›è°ƒæ¥è¿›è¡Œä¼˜åŒ–ï¼Œåœ¨å°†æ¥çš„ç‰ˆæœ¬ä¸­ä¼šå¾—åˆ°æ”¹å–„ã€‚</p>
<h3 id="å››ã€J2V8çš„Androidå¼€å‘å®ä¾‹"><a href="#å››ã€J2V8çš„Androidå¼€å‘å®ä¾‹" class="headerlink" title="å››ã€J2V8çš„Androidå¼€å‘å®ä¾‹"></a>å››ã€J2V8çš„Androidå¼€å‘å®ä¾‹</h3><p>æœ‰ä»¥ä¸‹ä¸€æ®µJSä»£ç ï¼Œå…¶ä¸­Canvasç»˜åˆ¶äº†ä¸€äº›ç®€å•çš„å›¾å½¢ï¼š</p>
<pre><code>var c=document.getElementById(&quot;myCanvas&quot;);
var ctx=c.getContext(&quot;2d&quot;);

ctx.beginPath();
ctx.arc(100, 100, 25, 0, 360, false);
ctx.moveTo(20,20);
ctx.lineTo(20,100);
ctx.lineTo(70,100);
ctx.moveTo(100, 100);
ctx.setLineWidth(15);
ctx.setStrokeColor(&quot;#188ffc&quot;);
ctx.stroke();

ctx.setFillColor(&quot;#188ffc&quot;);
ctx.fillText(&quot;Hello World!&quot;,150,50);
</code></pre><p>å…¶åœ¨Webç«¯ç»˜åˆ¶æ•ˆæœå¦‚ä¸‹ï¼š</p>
<p><img src="web_shape.png" alt="HelloWorld"></p>
<p>å®ä¾‹ä¸­ï¼Œå€ŸåŠ©J2V8åœ¨Androidç«¯è¿è¡ŒåŒæ ·ä¸€æ®µè„šæœ¬ï¼Œä½¿å›¾å½¢ç»˜åˆ¶åˆ°Android Canvasä¸­ã€‚ä¸‹é¢ç»™å‡ºç®€å•å®ç°ï¼Œä¸»è¦æ€è·¯ä¸ºè‡ªå®šä¹‰Viewï¼ŒJSä¸­å°†è¦ç»˜åˆ¶çš„å›¾å½¢å…ˆå­˜å‚¨åˆ°åœ¨Listä¸­ï¼Œå¾…æ•´ä¸ªJSè„šæœ¬æ‰§è¡Œå®Œæ¯•ï¼Œå†å°†æ‰€æœ‰å›¾å½¢åœ¨<code>View.onDraw(Canvas canvas)</code>ä¸­é€šè¿‡Android Canvasç»˜åˆ¶ã€‚</p>
<ol>
<li><p>å°†ctxå°è£…ä¸ºV8Objectï¼Œå¹¶åœ¨å…¶ä¸­å¯¹åº”å®ç°JS Canvasçš„æ–¹æ³•</p>
<pre><code>public class JustContext {
    protected V8 mRuntime;
    protected V8Object mCtx;
    private ArrayList&lt;AbstractDraw&gt; mShapeList = new ArrayList&lt;&gt;();

    public JustContext(V8 v8Runtime) {
        mRuntime = v8Runtime;
        initCtx();
    }

    public V8Object getCtx() {
        return mCtx;
    }

    public ArrayList&lt;AbstractDraw&gt; getShapeList() {
        return mShapeList;
    }

    protected void initCtx() {
        mCtx = new V8Object(mRuntime);

        //å°†Javaæ–¹æ³•æ³¨å†Œåˆ°è¯¥V8Objectä¸­
        mCtx.registerJavaMethod(this, &quot;beginPath&quot;, &quot;beginPath&quot;, null);
        mCtx.registerJavaMethod(this, &quot;closePath&quot;, &quot;closePath&quot;, null);

        ...
    }

    public void clean() {
        mCtx.release();
    }

    public void beginPath() {...}

    public void closePath() {...}

    ...
}
</code></pre></li>
</ol>
<ol>
<li><p>è‡ªå®šä¹‰Viewï¼Œåœ¨Viewçš„<code>onDraw(Canvas canvas)</code>æ–¹æ³•ä¸­å°†ä¼ å…¥çš„å›¾å½¢Listç»˜åˆ¶å‡ºæ¥</p>
<pre><code>public class JustView extends View implements Serializable {
    ...

    private ArrayList&lt;AbstractDraw&gt; mShapeList = new ArrayList&lt;&gt;();

    public void setShapeList(ArrayList&lt;AbstractDraw&gt; shapeList) {
        this.mShapeList = shapeList;
    }

    @Override
    protected void onDraw(Canvas canvas) {
        super.onDraw(canvas);

        for (AbstractDraw abstractDraw : mShapeList) {
            abstractDraw.draw(canvas);
        }
    }

    ...
}
</code></pre></li>
<li><p>å°†ctxæ³¨å†Œåˆ°JSä¸Šä¸‹æ–‡ï¼Œå¹¶æ‰§è¡ŒJSä»£ç ï¼Œæ‰§è¡Œå®Œæ¯•åå°†ç»˜åˆ¶å›¾å½¢Listä¼ é€’ç»™View</p>
<pre><code>JustView mJustView;
...

public void runJs(String js) {
    V8 context = V8.createV8Runtime();
    JustContext ctx = new JustContext(context);
    context.add(&quot;ctx&quot;, ctx.getCtx());
    context.executeScript(js);

    //é‡Šæ”¾å†…å­˜
    ctx.clean();
    context.release();

    mJustView.setShapeList(ctx.getShapeList());
}

...
</code></pre></li>
</ol>
<ol>
<li><p>å› ä¸ºå·²å°†ctxæ³¨å†Œåˆ°JSä¸Šä¸‹æ–‡ï¼Œå› æ­¤å¯ä»¥ç›´æ¥ä½¿ç”¨<code>ctx</code>å˜é‡ï¼Œå¹¶è¿è¡Œå¦‚ä¸‹JSä»£ç </p>
<pre><code>ctx.beginPath();
ctx.arc(100, 100, 25, 0, 360, false);
ctx.moveTo(20,20);
ctx.lineTo(20,100);
ctx.lineTo(70,100);
ctx.moveTo(100, 100);
ctx.setLineWidth(15);
ctx.setStrokeColor(&quot;#188ffc&quot;);
ctx.stroke();        
ctx.setFillColor(&quot;#188ffc&quot;);
ctx.fillText(&quot;Hello World!&quot;,150,50);
</code></pre><p> ç»˜åˆ¶ç»“æœå¦‚ä¸‹ï¼š</p>
<p> <img src="android_shape.png" alt="HelloWorld"></p>
</li>
</ol>
<p>ä»¥ä¸Šä»…æ˜¯è¯¥å®ä¾‹çš„ç®€å•å®ç°ï¼Œè¯¦ç»†çš„ä»£ç å’Œè®¾è®¡å¯ä»¥æ ¹æ®éœ€æ±‚çš„ä¸åŒè€Œè¿›è¡Œç»†åŒ–ï¼Œæ­¤å¤„(<a href="https://github.com/LiuHongtao/JustDraw)æä¾›ä¸€ä»½å…·ä½“å®ç°çš„å‚è€ƒã€‚ç”±äºæ¯æ‰§è¡Œä¸€ä¸ªCanvasæ–¹æ³•éƒ½å°†è°ƒç”¨ä¸€æ¬¡Javaæ–¹æ³•ï¼Œè¯¥æ–¹æ¡ˆå½“ç»˜åˆ¶é‡è¿‡å¤§çš„æ—¶å€™ä¼šå‡ºç°JNIè°ƒç”¨çš„æ€§èƒ½é—®é¢˜ï¼Œåœ¨æ€§èƒ½æ–¹é¢ä¹Ÿå­˜åœ¨ä¼˜åŒ–çš„ç©ºé—´ï¼Œåç»­å·¥ä½œä¸­å°†è¿›è¡Œè°ƒç”¨çš„ä¼˜åŒ–ï¼Œå‡å°‘JNIè°ƒç”¨æ¬¡æ•°ã€‚" target="_blank" rel="external">https://github.com/LiuHongtao/JustDraw)æä¾›ä¸€ä»½å…·ä½“å®ç°çš„å‚è€ƒã€‚ç”±äºæ¯æ‰§è¡Œä¸€ä¸ªCanvasæ–¹æ³•éƒ½å°†è°ƒç”¨ä¸€æ¬¡Javaæ–¹æ³•ï¼Œè¯¥æ–¹æ¡ˆå½“ç»˜åˆ¶é‡è¿‡å¤§çš„æ—¶å€™ä¼šå‡ºç°JNIè°ƒç”¨çš„æ€§èƒ½é—®é¢˜ï¼Œåœ¨æ€§èƒ½æ–¹é¢ä¹Ÿå­˜åœ¨ä¼˜åŒ–çš„ç©ºé—´ï¼Œåç»­å·¥ä½œä¸­å°†è¿›è¡Œè°ƒç”¨çš„ä¼˜åŒ–ï¼Œå‡å°‘JNIè°ƒç”¨æ¬¡æ•°ã€‚</a></p>
<p>J2V8çš„å›¢é˜Ÿå¼€å‘çš„ä¸€å¥—ç§»åŠ¨ç«¯è·¨å¹³å°æ¡†æ¶<strong>Tabris.js</strong>(<a href="https://tabrisjs.com/)ï¼Œæ”¯æŒAndroidå’ŒiOSå¹³å°ï¼Œåˆäºè¿‘æœŸå®£å¸ƒæ”¯æŒWindows" target="_blank" rel="external">https://tabrisjs.com/)ï¼Œæ”¯æŒAndroidå’ŒiOSå¹³å°ï¼Œåˆäºè¿‘æœŸå®£å¸ƒæ”¯æŒWindows</a> 10ã€‚è¯¥æ¡†æ¶æ—¨åœ¨ç¼–å†™ä¸€ä»½JavaScriptä»£ç ï¼Œè€Œèƒ½ç”ŸæˆAndroidå’ŒiOSä¸¤ä¸ªå¹³å°çš„æœ¬åœ°åº”ç”¨ã€‚å®ƒåœ¨Androidä¸Šä½¿ç”¨äº†J2V8ä½œä¸ºJSå¼•æ“æ–¹æ¡ˆï¼Œåœ¨iOSä¸Šä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„JSCoreã€‚</p>
<p>ä¸åŒäºReactNativeã€Weexä¹‹ç±»çš„æ¡†æ¶ï¼Œå®ƒçš„äº®ç‚¹åœ¨äºä¸é€šè¿‡WebViewï¼Œä½†å´èƒ½ä½¿ç”¨Web APIsï¼Œå¦‚Canvas 2d contextï¼ˆæ®äº†è§£ï¼ŒWeexä¹Ÿæ­£åœ¨æµ‹è¯•Canvasç»„ä»¶å¹¶å³å°†å¼€æºï¼‰ã€XMLHttpRequestã€localStorageã€‚è¯¥æ¡†æ¶é€šè¿‡æ‰¹å¤„ç†å›è°ƒå‡å°‘äº†JNIçš„è°ƒç”¨ï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šè§£å†³äº†JNIæ€§èƒ½é—®é¢˜ï¼Œä¾‹å¦‚å…¶Canvasç›¸å…³ä»£ç <code>tabris.CanvasContext</code>ä¸­ï¼Œå…ˆå°†æ¯æ¬¡è°ƒç”¨çš„Canvasæ–¹æ³•å’Œå‚æ•°å­˜å‚¨èµ·æ¥ï¼Œå¹¶åœ¨é€‚å½“çš„æ—¶å€™é€šè¿‡ä¸€æ¬¡JNIè°ƒç”¨æ¥ä¼ é€’è¦æ‰§è¡Œçš„Canvasæ–¹æ³•ï¼Œç›¸å…³ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code>defineMethod(&quot;fillText&quot;, 3, function(text, x, y /* , maxWidth */) {
    this._strings.push(text);
    this._booleans.push(false, false, false);
    this._doubles.push(x, y);
});

function defineMethod(name, reqArgCount, fn) {
    tabris.CanvasContext.prototype[name] = function() {
        if (reqArgCount &amp;&amp; arguments.length &lt; reqArgCount) {
            throw new Error(&quot;Not enough arguments to CanvasContext.&quot; + name);
        }
        this._pushOperation(name);
        if (fn) {
            fn.apply(this, arguments);
        }
    };
}

_pushOperation: function(operation) {
    if (this._opCodes.indexOf(operation) &lt; 0) {
        this._newOpCodes.push(operation);
        this._opCodes.push(operation);
    }
    this._operations.push(this._opCodes.indexOf(operation));
}

_flush: function() {
    if (this._operations.length &gt; 0) {
        this._gc._nativeCall(&quot;draw&quot;, {packedOperations: [
          this._newOpCodes,
          this._operations,
          this._doubles,
          this._booleans,
          this._strings,
          this._ints]});
        this._newOpCodes = [];
      this._operations = [];
      this._doubles = [];
      this._booleans = [];
      this._strings = [];
      this._ints = [];
    }
}
</code></pre><p>ä¹Ÿå°±æ˜¯è¯´Tabris.jsæ›´å®Œæ•´çš„çš„å®ç°äº†æœ¬èŠ‚ä¸­çš„æ–¹æ¡ˆï¼Œè¿™ä¹Ÿä½¿å¾—â€œå°†Webç«¯JSåº“ç›´æ¥æ‹¿åˆ°ç§»åŠ¨ç«¯æ‰§è¡Œï¼Œå¹¶ç”±æœ¬åœ°è¾“å‡ºç»“æœâ€å˜å¾—æ›´åŠ å®¹æ˜“ã€‚</p>
<p>ç›¸å…³æ–‡ç« </p>
<ul>
<li>Developing a mobile cross-platform library - Part 3. JavaScript</li>
</ul>
<p>(<a href="https://www.skyscanner.net/blogs/developing-mobile-cross-platform-library-part-3-javascript" target="_blank" rel="external">https://www.skyscanner.net/blogs/developing-mobile-cross-platform-library-part-3-javascript</a>)</p>
<ul>
<li>Part I: How to Choose a JavaScript Engine for iOS and Android Development</li>
</ul>
<p>(<a href="http://openaphid.github.io/blog/2013/01/17/part-i-how-to-choose-a-javascript-engine-for-ios-and-android-apps/" target="_blank" rel="external">http://openaphid.github.io/blog/2013/01/17/part-i-how-to-choose-a-javascript-engine-for-ios-and-android-apps/</a>)</p>
<ul>
<li>Getting Started With J2V8</li>
</ul>
<p>(<a href="http://eclipsesource.com/blogs/getting-started-with-j2v8/" target="_blank" rel="external">http://eclipsesource.com/blogs/getting-started-with-j2v8/</a>)</p>
<ul>
<li>J2V8-A Highly Efficient JS Runtime For Java</li>
</ul>
<p>(<a href="https://www.eclipsecon.org/na2015/sites/default/files/slides/J2V8_0.pdf" target="_blank" rel="external">https://www.eclipsecon.org/na2015/sites/default/files/slides/J2V8_0.pdf</a>)</p>
<ul>
<li>Smile: Deploying a mobile app has never been so easy</li>
</ul>
<p>(<a href="http://eclipsesource.com/blogs/2016/08/10/smile-deploying-a-mobile-app-has-never-been-so-easy/" target="_blank" rel="external">http://eclipsesource.com/blogs/2016/08/10/smile-deploying-a-mobile-app-has-never-been-so-easy/</a>)</p>

      
    </div>
    <footer>
      
        
        
  
  <div class="tags">
    <a href="/tags/android/">android</a>
  </div>

        
  <div class="addthis addthis_toolbox addthis_default_style">
    
      <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
    
    
      <a class="addthis_button_tweet"></a>
    
    
      <a class="addthis_button_google_plusone" g:plusone:size="medium"></a>
    
    
      <a class="addthis_button_pinterest_pinit" pi:pinit:layout="horizontal"></a>
    
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">ç•™è¨€</h1>

  
      <div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=123456789012345";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

<div class="fb-comments" data-href="http://hellojql.github.io/2016/12/26/NeteaseFed/android/Android JSå¼•æ“/index.html" data-num-posts="5" data-width="840" data-colorscheme="light"></div>
      
  
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  <SCRIPT language=javascript>
function search(formname) {
    formname.method = "get";
    formname.action = "http://www.baidu.com/baidu";
    document.search_form.word.value = document.search_form.word.value + " site:hellojql.github.ioâ€;
    return true;
}
</SCRIPT>

<div class="search">
    <form name="search_form" target="_blank" onsubmit="search(this)">
        <input type="search" name="word" results="0" placeholder="" onblur="this.value=''">
        <!-- <input type="submit" value="æœç´¢"> -->
    </form>
</div>

  

  
<div class="widget tag">
  <h3 class="title">æ ‡ç­¾</h3>
  <ul class="entry">
  
    <li><a href="/tags/android/">android</a><small>3</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2016 ç½‘æ˜“å‰ç«¯æŠ€æœ¯éƒ¨
  
</div>
<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>
